<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>redisåŸºç¡€ | é›¨æ°´çš„å¤©ç©ºè½äº†é›¨</title><meta name="keywords" content="æ•°æ®åº“,redis,noSql"><meta name="author" content="rain-Sky"><meta name="copyright" content="rain-Sky"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ä¸ºä»€ä¹ˆä½¿ç”¨noSql noSqlï¼Œä¸ä»…ä»…æ˜¯sql  å•æœºmysqlæ—¶ä»£åœ¨90å¹´ä»£ï¼Œä¸€ä¸ªç½‘ç«™çš„è®¿é—®é‡ä¸€èˆ¬éƒ½ä¸å¤§ï¼Œç”¨å•ä¸ªæ•°æ®åº“å®Œå…¨å¯ä»¥è½»æ¾åº”ä»˜ã€‚åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„éƒ½æ˜¯é™æ€ç½‘é¡µï¼ŒåŠ¨æ€äº¤äº’ç±»å‹çš„ç½‘ç«™ä¸å¤šï¼Œæ— è®ºè¯»å†™éƒ½åœ¨åŒä¸€ä¸ªå®ä¾‹ä¸­å®Œæˆã€‚   APP åº”ç”¨ç«¯ DAL æ•°æ®è®¿é—®å±‚ï¼ˆjdbcï¼Œæˆ–è€…ormæ¡†æ¶å¦‚mybatiesï¼ŒHibernateç­‰ï¼‰ mysql instance æ•°æ®åº“å®ä¾‹  Memcached+">
<meta property="og:type" content="article">
<meta property="og:title" content="redisåŸºç¡€">
<meta property="og:url" content="https://rain-sky.github.io/2021/07/24/redis%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="é›¨æ°´çš„å¤©ç©ºè½äº†é›¨">
<meta property="og:description" content="ä¸ºä»€ä¹ˆä½¿ç”¨noSql noSqlï¼Œä¸ä»…ä»…æ˜¯sql  å•æœºmysqlæ—¶ä»£åœ¨90å¹´ä»£ï¼Œä¸€ä¸ªç½‘ç«™çš„è®¿é—®é‡ä¸€èˆ¬éƒ½ä¸å¤§ï¼Œç”¨å•ä¸ªæ•°æ®åº“å®Œå…¨å¯ä»¥è½»æ¾åº”ä»˜ã€‚åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„éƒ½æ˜¯é™æ€ç½‘é¡µï¼ŒåŠ¨æ€äº¤äº’ç±»å‹çš„ç½‘ç«™ä¸å¤šï¼Œæ— è®ºè¯»å†™éƒ½åœ¨åŒä¸€ä¸ªå®ä¾‹ä¸­å®Œæˆã€‚   APP åº”ç”¨ç«¯ DAL æ•°æ®è®¿é—®å±‚ï¼ˆjdbcï¼Œæˆ–è€…ormæ¡†æ¶å¦‚mybatiesï¼ŒHibernateç­‰ï¼‰ mysql instance æ•°æ®åº“å®ä¾‹  Memcached+">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://rain-sky.github.io/img/10006.jpg">
<meta property="article:published_time" content="2021-07-24T07:41:03.000Z">
<meta property="article:modified_time" content="2021-08-04T08:56:20.226Z">
<meta property="article:author" content="rain-Sky">
<meta property="article:tag" content="æ•°æ®åº“">
<meta property="article:tag" content="redis">
<meta property="article:tag" content="noSql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rain-sky.github.io/img/10006.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://rain-sky.github.io/2021/07/24/redis%E5%9F%BA%E7%A1%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/rain-sky" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-04 16:56:20'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/static-butterfly/dist/css/index.min.css"><meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="é›¨æ°´çš„å¤©ç©ºè½äº†é›¨" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://gitee.com/rain-sky/images/raw/master/20210814102605.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">37</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-film"></i><span> ç›¸å†Œ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> åˆ—è¡¨</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-heart"></i><span> ç•ªå‰§</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">é›¨æ°´çš„å¤©ç©ºè½äº†é›¨</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-film"></i><span> ç›¸å†Œ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> åˆ—è¡¨</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-heart"></i><span> ç•ªå‰§</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">redisåŸºç¡€</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-07-24T07:41:03.000Z" title="Created 2021-07-24 15:41:03">2021-07-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-08-04T08:56:20.226Z" title="Updated 2021-08-04 16:56:20">2021-08-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">13.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>44min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="redisåŸºç¡€"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨noSql"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨noSql" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨noSql"></a>ä¸ºä»€ä¹ˆä½¿ç”¨noSql</h2><blockquote>
<p>noSqlï¼Œä¸ä»…ä»…æ˜¯sql</p>
</blockquote>
<h3 id="å•æœºmysqlæ—¶ä»£"><a href="#å•æœºmysqlæ—¶ä»£" class="headerlink" title="å•æœºmysqlæ—¶ä»£"></a>å•æœºmysqlæ—¶ä»£</h3><p>åœ¨90å¹´ä»£ï¼Œä¸€ä¸ªç½‘ç«™çš„è®¿é—®é‡ä¸€èˆ¬éƒ½ä¸å¤§ï¼Œç”¨å•ä¸ªæ•°æ®åº“å®Œå…¨å¯ä»¥è½»æ¾åº”ä»˜ã€‚<br>åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„éƒ½æ˜¯é™æ€ç½‘é¡µï¼ŒåŠ¨æ€äº¤äº’ç±»å‹çš„ç½‘ç«™ä¸å¤šï¼Œæ— è®ºè¯»å†™éƒ½åœ¨åŒä¸€ä¸ªå®ä¾‹ä¸­å®Œæˆã€‚</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210726114217.png"></p>
<ul>
<li>APP åº”ç”¨ç«¯</li>
<li>DAL æ•°æ®è®¿é—®å±‚ï¼ˆjdbcï¼Œæˆ–è€…ormæ¡†æ¶å¦‚mybatiesï¼ŒHibernateç­‰ï¼‰</li>
<li>mysql instance æ•°æ®åº“å®ä¾‹</li>
</ul>
<h3 id="Memcached-MySQL-å‚ç›´æ‹†åˆ†"><a href="#Memcached-MySQL-å‚ç›´æ‹†åˆ†" class="headerlink" title="Memcached+MySQL+å‚ç›´æ‹†åˆ†"></a>Memcached+MySQL+å‚ç›´æ‹†åˆ†</h3><p>â€ƒåæ¥ï¼Œéšç€è®¿é—®é‡çš„ä¸Šå‡ï¼Œå‡ ä¹å¤§éƒ¨åˆ†ä½¿ç”¨MySQLæ¶æ„çš„ç½‘ç«™åœ¨æ•°æ®åº“ä¸Šéƒ½å¼€å§‹å‡ºç°äº†æ€§èƒ½é—®é¢˜ï¼Œwebç¨‹åºä¸å†ä»…ä»…ä¸“æ³¨åœ¨åŠŸèƒ½ä¸Šï¼ŒåŒæ—¶ä¹Ÿåœ¨è¿½æ±‚æ€§èƒ½ã€‚ç¨‹åºå‘˜ä»¬å¼€å§‹å¤§é‡çš„ä½¿ç”¨ç¼“å­˜æŠ€æœ¯æ¥ç¼“è§£æ•°æ®åº“çš„å‹åŠ›ï¼Œä¼˜åŒ–æ•°æ®åº“çš„ç»“æ„å’Œç´¢å¼•ã€‚å¼€å§‹æ¯”è¾ƒæµè¡Œçš„æ˜¯é€šè¿‡æ–‡ä»¶ç¼“å­˜æ¥ç¼“è§£æ•°æ®åº“å‹åŠ›ï¼Œä½†æ˜¯å½“è®¿é—®é‡ç»§ç»­å¢å¤§çš„æ—¶å€™ï¼Œå¤šå°webæœºå™¨é€šè¿‡æ–‡ä»¶ç¼“å­˜ä¸èƒ½å…±äº«ï¼Œå¤§é‡çš„å°æ–‡ä»¶ç¼“å­˜ä¹Ÿå¸¦äº†äº†æ¯”è¾ƒé«˜çš„IOå‹åŠ›ã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼ŒMemcachedå°±è‡ªç„¶çš„æˆä¸ºä¸€ä¸ªéå¸¸æ—¶å°šçš„æŠ€æœ¯äº§å“ã€‚</p>
<p>â€ƒMemcachedä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„åˆ†å¸ƒå¼çš„ç¼“å­˜æœåŠ¡å™¨ï¼Œä¸ºå¤šä¸ªwebæœåŠ¡å™¨æä¾›äº†ä¸€ä¸ªå…±äº«çš„é«˜æ€§èƒ½ç¼“å­˜æœåŠ¡ï¼Œåœ¨MemcachedæœåŠ¡å™¨ä¸Šï¼Œåˆå‘å±•äº†æ ¹æ®hashç®—æ³•æ¥è¿›è¡Œå¤šå°Memcachedç¼“å­˜æœåŠ¡çš„æ‰©å±•ï¼Œç„¶ååˆå‡ºç°äº†ä¸€è‡´æ€§hashæ¥è§£å†³å¢åŠ æˆ–å‡å°‘ç¼“å­˜æœåŠ¡å™¨å¯¼è‡´é‡æ–°hashå¸¦æ¥çš„å¤§é‡ç¼“å­˜å¤±æ•ˆçš„å¼Šç«¯ã€‚</p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210726114531.png" style="zoom:80%;">

<h3 id="Mysqlä¸»ä»è¯»å†™åˆ†ç¦»"><a href="#Mysqlä¸»ä»è¯»å†™åˆ†ç¦»" class="headerlink" title="Mysqlä¸»ä»è¯»å†™åˆ†ç¦»"></a>Mysqlä¸»ä»è¯»å†™åˆ†ç¦»</h3><p>ç”±äºæ•°æ®åº“çš„å†™å…¥å‹åŠ›å¢åŠ ï¼ŒMemcachedåªèƒ½ç¼“è§£æ•°æ®åº“çš„è¯»å–å‹åŠ›ã€‚è¯»å†™é›†ä¸­åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸Šè®©æ•°æ®åº“ä¸å ªé‡è´Ÿï¼Œå¤§éƒ¨åˆ†ç½‘ç«™å¼€å§‹ä½¿ç”¨ä¸»ä»å¤åˆ¶æŠ€æœ¯æ¥è¾¾åˆ°è¯»å†™åˆ†ç¦»ï¼Œä»¥æé«˜è¯»å†™æ€§èƒ½å’Œè¯»åº“çš„å¯æ‰©å±•æ€§ã€‚</p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210726121707.png" style="zoom:80%;">

<ul>
<li>M ä¸»æœåŠ¡å™¨ï¼Œè´Ÿè´£å†™ä¸šåŠ¡</li>
<li>S ä»æœåŠ¡å™¨ï¼ŒåŒæ­¥Mæ•°æ®</li>
</ul>
<h3 id="åˆ†åº“åˆ†è¡¨-æ°´å¹³æ‹†åˆ†-mysqlé›†ç¾¤"><a href="#åˆ†åº“åˆ†è¡¨-æ°´å¹³æ‹†åˆ†-mysqlé›†ç¾¤" class="headerlink" title="åˆ†åº“åˆ†è¡¨+æ°´å¹³æ‹†åˆ†+mysqlé›†ç¾¤"></a>åˆ†åº“åˆ†è¡¨+æ°´å¹³æ‹†åˆ†+mysqlé›†ç¾¤</h3><p>åœ¨Memcachedçš„é«˜é€Ÿç¼“å­˜ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿™æ—¶MySQLä¸»åº“çš„å†™å‹åŠ›å¼€å§‹å‡ºç°ç“¶é¢ˆï¼Œè€Œæ•°æ®é‡çš„æŒç»­çŒ›å¢ï¼Œç”±äºMyISAMåœ¨å†™æ•°æ®çš„æ—¶å€™ä¼šä½¿ç”¨è¡¨é”ï¼Œåœ¨é«˜å¹¶å‘å†™æ•°æ®çš„æƒ…å†µä¸‹ä¼šå‡ºç°ä¸¥é‡çš„é”é—®é¢˜ï¼Œå¤§é‡çš„é«˜å¹¶å‘MySQLåº”ç”¨å¼€å§‹ä½¿ç”¨InnoDBå¼•æ“ä»£æ›¿MyISAMã€‚</p>
<ul>
<li>MyISAM è¡¨é”</li>
<li>InnoDB è¡Œé”</li>
</ul>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210726122057.png"></p>
<p><strong>ä¸€ä¸ªç°ä»£äº’è”ç½‘æœåŠ¡æ¶æ„æ¨¡å‹</strong></p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210726123128.png" style="zoom: 67%;">

<p>æœ€å‰é¢çš„æ˜¯ä¼ä¸šçº§é˜²ç«å¢™ï¼Œåé¢é€šè¿‡è´Ÿè½½å‡è¡¡ä¸»æœºï¼ˆè½¯è´Ÿè½½ï¼šNginxï¼Œç¡¬è´Ÿè½½ï¼šF5ï¼‰åœ¨ web æœåŠ¡å™¨é›†ç¾¤ä¹‹é—´è¿›è¡Œè°ƒåº¦ï¼Œå†ç”±å…·ä½“çš„ web æœåŠ¡å™¨ï¼ˆTomcatï¼‰å»è®¿é—®ç¼“å­˜ï¼Œè®¿é—®æ•°æ®åº“ã€‚</p>
<h3 id="noSqlçš„ä¼˜åŠ¿"><a href="#noSqlçš„ä¼˜åŠ¿" class="headerlink" title="noSqlçš„ä¼˜åŠ¿"></a>noSqlçš„ä¼˜åŠ¿</h3><ul>
<li><p>æ˜“æ‰©å±•<br> NoSQLæ•°æ®åº“ç§ç±»ç¹å¤šï¼Œä½†æ˜¯ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹éƒ½æ˜¯å»æ‰å…³ç³»æ•°æ®åº“çš„å…³ç³»å‹ç‰¹æ€§ã€‚æ•°æ®ä¹‹é—´æ— å…³ç³»ï¼Œè¿™æ ·å°±éå¸¸å®¹æ˜“æ‰©å±•ã€‚ä¹Ÿæ— å½¢ä¹‹é—´ï¼Œåœ¨æ¶æ„çš„å±‚é¢ä¸Šå¸¦æ¥äº†å¯æ‰©å±•çš„èƒ½åŠ›ã€‚</p>
</li>
<li><p>å¤§æ•°æ®é‡ï¼Œé«˜æ€§èƒ½<br> NoSQLæ•°æ®åº“éƒ½å…·æœ‰éå¸¸é«˜çš„è¯»å†™æ€§èƒ½ï¼Œå°¤å…¶åœ¨å¤§æ•°æ®é‡ä¸‹ï¼ŒåŒæ ·è¡¨ç°ä¼˜ç§€ã€‚è¿™å¾—ç›Šäºå®ƒçš„æ— å…³ç³»æ€§ï¼Œæ•°æ®åº“çš„ç»“æ„ç®€å•ã€‚ä¸€èˆ¬MySQLä½¿ç”¨Query Cacheï¼Œæ¯æ¬¡è¡¨çš„æ›´æ–°Cacheå°±å¤±æ•ˆï¼Œæ˜¯ä¸€ç§å¤§ç²’åº¦çš„Cacheï¼Œåœ¨é’ˆå¯¹web2.0çš„äº¤äº’é¢‘ç¹çš„åº”ç”¨ï¼ŒCacheæ€§èƒ½ä¸é«˜ã€‚è€ŒNoSQLçš„Cacheæ˜¯è®°å½•çº§çš„ï¼Œæ˜¯ä¸€ç§ç»†ç²’åº¦çš„Cacheï¼Œæ‰€ä»¥NoSQLåœ¨è¿™ä¸ªå±‚é¢ä¸Šæ¥è¯´å°±è¦æ€§èƒ½é«˜å¾ˆå¤šäº†ã€‚</p>
</li>
<li><p>çµæ´»çš„æ•°æ®æ¨¡å‹<br> NoSQLæ— éœ€äº‹å…ˆä¸ºè¦å­˜å‚¨çš„æ•°æ®å»ºç«‹å­—æ®µï¼Œéšæ—¶å¯ä»¥å­˜å‚¨è‡ªå®šä¹‰çš„æ•°æ®æ ¼å¼ã€‚è€Œåœ¨å…³ç³»æ•°æ®åº“é‡Œï¼Œå¢åˆ å­—æ®µæ˜¯ä¸€ä»¶éå¸¸éº»çƒ¦çš„äº‹æƒ…ã€‚å¦‚æœæ˜¯éå¸¸å¤§æ•°æ®é‡çš„è¡¨ï¼Œå¢åŠ å­—æ®µç®€ç›´å°±æ˜¯ä¸€ä¸ªå™©æ¢¦ã€‚è¿™ç‚¹åœ¨å¤§æ•°æ®é‡çš„web2.0æ—¶ä»£å°¤å…¶æ˜æ˜¾ã€‚</p>
</li>
<li><p>é«˜å¯ç”¨<br> NoSQLåœ¨ä¸å¤ªå½±å“æ€§èƒ½çš„æƒ…å†µï¼Œå°±å¯ä»¥æ–¹ä¾¿çš„å®ç°é«˜å¯ç”¨çš„æ¶æ„ã€‚æ¯”å¦‚Cassandraï¼ŒHBaseæ¨¡å‹ï¼Œé€šè¿‡å¤åˆ¶æ¨¡å‹ä¹Ÿèƒ½å®ç°é«˜å¯ç”¨ã€‚</p>
</li>
</ul>
<p><strong>ä¸€äº›å¸¸ç”¨çš„nosqlä¸¾ä¾‹</strong></p>
<ul>
<li>CouchDB ï¼šCouchDBæ˜¯ä¸€ç§<strong>é¢å‘æ–‡æ¡£</strong>(document-oriented)çš„nosqlæ•°æ®åº“ï¼Œæ–‡æ¡£çš„å­˜å‚¨æ ¼å¼é€šè¿‡JSONè¿›è¡Œæè¿°ï¼Œåœ¨ç»“æ„éƒ¨ç½²ä¸Šé‡‡ç”¨çš„æ˜¯peer-basedæ–¹å¼ï¼Œå³æ¯å°æœºå™¨åœ¨åŠŸèƒ½ä¸Šæ¥è®²æ˜¯åŒç­‰é‡è¦çš„ï¼Œæ²¡æœ‰masterå’Œslaveçš„åŒºåˆ†ï¼Œæ‰€å­˜å‚¨çš„æ•°æ®ä¹Ÿéƒ½æ˜¯ç›¸åŒçš„(æ²¡æœ‰åšåˆ°æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨)ï¼Œç±»ä¼¼äºSubversionä¸­ç‰ˆæœ¬åº“å’Œå·¥ä½œæ‹·è´çš„æ¦‚å¿µã€‚</li>
<li>Redisï¼šRedisæ˜¯ä¸€ç§åŸºäº<strong>key-valueå­˜å‚¨æ ¼å¼</strong>çš„nosqlæ•°æ®åº“ï¼Œåœ¨ç»“æ„éƒ¨ç½²ä¸Šé‡‡ç”¨äº†master/slaveçš„æ–¹å¼ï¼Œå…¶ä¸­slaveèŠ‚ç‚¹èµ·åˆ°å¤‡ä»½çš„ä½œç”¨ï¼Œå½“masterèŠ‚ç‚¹å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼ŒslaveèŠ‚ç‚¹å¯æ›¿æ¢æˆmasterï¼Œä»è€Œç¡®ä¿äº†ç³»ç»Ÿå®‰å…¨ç¨³å®šçš„ç‰¹æ€§ã€‚</li>
<li>MongoDBï¼šåŒCouchDBä¸€æ ·ï¼ŒMongoDBä¹Ÿæ˜¯ä¸€ç§<strong>é¢å‘æ–‡æ¡£</strong>çš„nosqlæ•°æ®åº“ï¼Œæ‰€ä¸åŒçš„æ˜¯åœ¨å­˜å‚¨æ–¹å¼ä¸Šé‡‡ç”¨çš„æ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå…¶éƒ¨ç½²ç»“æ„ä¸Redisç›¸ä¼¼(åŸºäºmaster/slaveæ–¹å¼)ï¼Œåªä¸è¿‡åŠŸèƒ½ç»„ä»¶è¾ƒRedisåˆ’åˆ†çš„æ›´åŠ è¯¦ç»†ã€‚</li>
</ul>
<p><strong>å››ç§nosqlå¯¹æ¯”</strong></p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210727145920.png"></p>
<h2 id="redis-ä»‹ç»"><a href="#redis-ä»‹ç»" class="headerlink" title="redis ä»‹ç»"></a>redis ä»‹ç»</h2><blockquote>
<p>åŸºäºredis6.xç‰ˆ</p>
</blockquote>
<p>Redisæ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSDè®¸å¯ï¼‰ï¼Œå†…å­˜å­˜å‚¨çš„æ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå¯ç”¨ä½œæ•°æ®åº“ï¼Œé«˜é€Ÿç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—ä»£ç†ã€‚å®ƒæ”¯æŒå­—ç¬¦ä¸²ã€å“ˆå¸Œè¡¨ã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆï¼Œä½å›¾ï¼Œhyperloglogsç­‰æ•°æ®ç±»å‹ã€‚å†…ç½®å¤åˆ¶ã€Luaè„šæœ¬ã€LRUæ”¶å›ã€äº‹åŠ¡ä»¥åŠä¸åŒçº§åˆ«ç£ç›˜æŒä¹…åŒ–åŠŸèƒ½ï¼ŒåŒæ—¶é€šè¿‡Redis Sentinelæä¾›é«˜å¯ç”¨ï¼Œé€šè¿‡Redis Clusteræä¾›è‡ªåŠ¨åˆ†åŒºã€‚</p>
<p><strong>Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</strong></p>
<ul>
<li>Redisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚</li>
<li>Redisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œåº”ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œ ç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚ åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚</li>
</ul>
<h3 id="linuxä¸‹å®‰è£…redis"><a href="#linuxä¸‹å®‰è£…redis" class="headerlink" title="linuxä¸‹å®‰è£…redis"></a>linuxä¸‹å®‰è£…redis</h3><p>å‡†å¤‡å¥½å‹ç¼©åŒ…ä¼ è¾“åˆ°Linuxç›®å½•</p>
<p><strong>è§£å‹åå¾—åˆ°redis</strong></p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210731174107.png"></p>
<p>è¿›å…¥è§£å‹åçš„æ–‡ä»¶</p>
<p>yum install gcc-c++</p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210731175718.png" style="zoom: 50%;">

<p>å®‰è£…redis6.Xä»¥ä¸Šç‰ˆæœ¬å®‰è£…6.0ä»¥ä¸Šç‰ˆæœ¬éœ€è¦å‡çº§gccåˆ°5.3åŠä»¥ä¸Š,å¦‚ä¸‹ï¼š</p>
<p>è¿è¡Œä¸‹é¢å‘½ä»¤å‡çº§gcc<br>#ç¬¬ä¸€æ­¥<br>sudo yum install centos-release-scl<br>#ç¬¬äºŒæ­¥<br>sudo yum install devtoolset-7-gcc*<br>#ç¬¬ä¸‰æ­¥<br>scl enable devtoolset-7 bash</p>
<p>æ›´æ–°å®Œæˆgccåæˆ‘ä»¬è¿›å…¥redisç›®å½•ä¸‹ï¼Œæ‰§è¡Œmake</p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210731180138.png" style="zoom:50%;">

<p>è‡³æ­¤redisåŸºæœ¬å®‰è£…å®Œæˆï¼Œé»˜è®¤å®‰è£…åˆ°/usr/local/binç›®å½•ä¸‹</p>
<p>å¤åˆ¶ä¸€ä»½redisé…ç½®æ–‡ä»¶åˆ°æ­¤ç›®å½•ä¸‹ï¼Œä¿®æ”¹æ­¤é…ç½®æ–‡ä»¶ï¼Œdaemonizeä¿®æ”¹ä¸ºyes,è®©redisåå°å¯åŠ¨</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210731183404.png"></p>
<p>æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210731183637.png"></p>
<p>è¿æ¥redisæœåŠ¡</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210731183754.png"></p>
<p>æŸ¥çœ‹redisæœåŠ¡æ˜¯å¦å¼€å¯</p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210731183950.png" style="zoom:67%;">

<p>æ–­å¼€redisæœåŠ¡</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210731184120.png"></p>
<p>å†æ¬¡æŸ¥çœ‹æœåŠ¡æ˜¯å¦å­˜åœ¨</p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210731184222.png" style="zoom:67%;">

<blockquote>
<p>redisçš„å®‰è£…ç›¸å…³å°±åˆ°æ­¤æä¸€æ®µè½~ğŸ’ª</p>
</blockquote>
<h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><h3 id="redisæ•°æ®åº“"><a href="#redisæ•°æ®åº“" class="headerlink" title="redisæ•°æ®åº“"></a>redisæ•°æ®åº“</h3><p>redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œé…ç½®æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬0ä¸ªï¼Œå¯ä»¥ä½¿ç”¨selectå‘½ä»¤åˆ‡æ¢æ•°æ®åº“ã€‚</p>
<p>åˆ‡æ¢æ•°æ®åº“ï¼šselect  7</p>
<p>æ•°æ®åº“å¤§å°ï¼šdbsize</p>
<p>è¾“å…¥ä¸€ä¸ªé”®å€¼å¯¹ï¼šset keyname value</p>
<p>å¾—åˆ°ä¸€ä¸ªvalueï¼šget  keyname</p>
<p>ä¿®æ”¹keyåç§°ï¼šrename key newkey</p>
<p>æŸ¥è¯¢æ‰€æœ‰çš„keyï¼škey *</p>
<p>æŸ¥è¯¢æŸä¸ªkeyæ˜¯å¦å­˜åœ¨ï¼šexists keynane</p>
<p>ç§»é™¤æŸä¸€ä¸ªkeyï¼šmove keyname  2ï¼ˆ2ä»£è¡¨ä»ç¬¬äºŒä¸ªæ•°æ®åº“ä¸­ç§»é™¤ï¼‰</p>
<p>æŸ¥è¯¢æŸä¸ªkeyè¿˜å‰©å¤šå°‘æ—¶é—´è¿‡æœŸï¼šttl keyname</p>
<p>è®¾ç½®æŸä¸ªé”®çš„è¿‡æœŸæ—¶é—´ï¼šexpire keyname 10(10såè¿‡æœŸ)</p>
<p>æŸ¥çœ‹å½“å‰keyçš„ç±»å‹ï¼štype keyname</p>
<p>æ¸…ç©ºå½“å‰æ•°æ®åº“ï¼šflushdb</p>
<p>æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“ï¼šflushall</p>
<p><strong>redisæ˜¯å•çº¿ç¨‹çš„</strong></p>
<blockquote>
<p>redisæ˜¯åŸºäºå†…å­˜æ“ä½œï¼Œcpuå¹¶ä¸æ˜¯redisçš„æ€§èƒ½ç“¶é¢ˆï¼Œredisçš„ç“¶é¢ˆæ˜¯æœºå™¨çš„å†…å­˜å’Œç½‘ç»œå¸¦å®½ã€‚</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆrediså•çº¿ç¨‹è¿™ä¹ˆå¿«ï¼Ÿ</p>
<p>è¯¯åŒº1ï¼šé«˜æ€§èƒ½çš„æœåŠ¡å™¨ä¸€å®šæ˜¯å¤šçº¿ç¨‹çš„ï¼Ÿ</p>
<p>è¯¯åŒº2ï¼šå¤šçº¿ç¨‹ä¸€å®šæ¯”å•çº¿ç¨‹æ•ˆç‡é«˜ï¼Ÿ</p>
<p>æ ¸å¿ƒï¼šredisæ˜¯å°†æ‰€æœ‰æ•°æ®å­˜æ”¾äºå†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è¯´redisä½¿ç”¨å•çº¿ç¨‹æ˜¯æœ€å¿«çš„ï¼Œå› ä¸ºæ²¡æœ‰CPUä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¯¹äºå†…å­˜ç³»ç»Ÿæ¥è¯´ï¼Œå¤šæ¬¡è¯»å†™éƒ½æ˜¯åœ¨ä¸€ä¸ªCPUä¸Šçš„ã€‚</p>
<h3 id="äº”å¤§æ•°æ®ç±»å‹"><a href="#äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="äº”å¤§æ•°æ®ç±»å‹"></a>äº”å¤§æ•°æ®ç±»å‹</h3><h4 id="Stringå­—ç¬¦ä¸²ç±»å‹"><a href="#Stringå­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="Stringå­—ç¬¦ä¸²ç±»å‹"></a>Stringå­—ç¬¦ä¸²ç±»å‹</h4><hr>
<p>åŸºæœ¬å‘½ä»¤æ“ä½œï¼š</p>
<p>set  name  rain è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ä¸º rain</p>
<p>append name sky ç»™åä¸ºnameçš„keyè¿½åŠ å­—ç¬¦skyï¼Œæ‰€ä»¥è¿½åŠ åä¸ºrainskyï¼ˆè‹¥æŒ‡å®škeynameä¸å­˜åœ¨ï¼Œåˆ™ç›¸å½“äºset keyï¼‰</p>
<p>strlen name è·å–nameçš„é•¿åº¦ï¼Œrainskyå³ä¸º7</p>
<p>set num 1 è®¾ç½®numåˆå§‹å€¼ä¸º1</p>
<p>incr numä½¿numè‡ªå¢1.å³ä¸º2</p>
<p>decr numä½¿numè‡ªå‡1ï¼Œå³ä¸º1</p>
<p>incrby num 10 ä½¿numè‡ªå¢10</p>
<p>decrby num 10ä½¿numè‡ªå‡10</p>
<hr>
<p>set str â€œhello,world!â€</p>
<p>getrange str 0 4è·å–str0-4åŒºé—´å†…å®¹ï¼ˆé—­åŒºé—´ï¼‰ï¼Œå³ä¸ºhello</p>
<p>setrange str 1 xxxxä»æŒ‡å®šä½ç½®å¼€å§‹ç”¨æŒ‡å®šå­—ç¬¦ä¸²ä½œæ›¿æ¢ï¼Œå³ä¸ºhxxxx,world!</p>
<hr>
<blockquote>
<p>setexä¸setnx</p>
</blockquote>
<p>SETEX key seconds value</p>
<p>å«ä¹‰ï¼š</p>
<p>â€‹     å°†å€¼ value å…³è”åˆ° key ï¼Œå¹¶å°† key çš„ç”Ÿå­˜æ—¶é—´è®¾ä¸º seconds (ä»¥ç§’ä¸ºå•ä½)ã€‚</p>
<p>â€‹     å¦‚æœ key å·²ç»å­˜åœ¨ï¼Œ SETEX å‘½ä»¤å°†è¦†å†™æ—§å€¼ã€‚</p>
<p>è¿”å›å€¼ï¼š</p>
<p>â€‹     è®¾ç½®æˆåŠŸæ—¶è¿”å› OK ã€‚</p>
<p>â€‹     å½“ seconds å‚æ•°ä¸åˆæ³•æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>SETNX key valueï¼ˆåˆ†å¸ƒå¼é”å¸¸ç”¨ï¼‰</p>
<p>å«ä¹‰ï¼š</p>
<p>â€‹     å°† key çš„å€¼è®¾ä¸º value ï¼Œå½“ä¸”ä»…å½“ key ä¸å­˜åœ¨ã€‚</p>
<p>â€‹     è‹¥ç»™å®šçš„ key å·²ç»å­˜åœ¨ï¼Œåˆ™ SETNX ä¸åšä»»ä½•åŠ¨ä½œã€‚</p>
<p>â€‹     SETNX æ˜¯ã€SET if Not eXistsã€(å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ SET)çš„ç®€å†™ã€‚</p>
<p>è¿”å›å€¼ï¼š</p>
<p>â€‹     è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚</p>
<p>â€‹     è®¾ç½®å¤±è´¥ï¼Œè¿”å› 0 ã€‚</p>
<blockquote>
<p>msetä¸mgetï¼Œmsetnx</p>
</blockquote>
<p>mset k1 v1 k2 v2 k3 v3â€¦ä¸€æ¬¡æ€§è¾“å…¥å¤šä¸ªå€¼</p>
<p>mget k1 k2 k3 ä¸€æ¬¡æ€§è·å–å¤šä¸ªå€¼</p>
<p>msetnx k1 v1 k2 v2 â€¦ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªå€¼ï¼Œå¦‚æœæœ‰ä¸€ä¸ªkeyå·²ç»å­˜åœ¨ï¼Œåˆ™æ•´ä¸ªå¥å­æ‰§è¡Œå¤±è´¥ï¼ˆåŸå­æ€§ï¼‰</p>
<blockquote>
<p>è®¾ç½®ä¸€ä¸ªå¯¹è±¡</p>
</blockquote>
<p>å¦‚ï¼šset user:1 {name:rain,age:14}</p>
<p>å¦ä¸€ç§è®¾è®¡ï¼š</p>
<p>mset user:1:name rain user:1:age 14</p>
<blockquote>
<p>getsetç»„åˆå‘½ä»¤</p>
</blockquote>
<p>getset name rainsky å…ˆè·å–å€¼å†é‡æ–°è®¾ç½®å€¼ï¼Œä¸å­˜åœ¨åˆ™è¿”å›nil</p>
<h4 id="Liståˆ—è¡¨"><a href="#Liståˆ—è¡¨" class="headerlink" title="Liståˆ—è¡¨"></a>Liståˆ—è¡¨</h4><p>Redisåˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼Œå¯å­˜åœ¨é‡å¤å€¼ã€‚</p>
<p><strong>åŸºæœ¬ç”¨æ³•</strong></p>
<p>æ­¤å¤„liståˆ—è¡¨åå³ä¸ºkey</p>
<p>lpush list cat å¾€åä¸ºlistçš„åˆ—è¡¨å·¦ä¾§æ·»åŠ ä¸€ä¸ªcat</p>
<p>è‹¥å†ä¸€æ¬¡æ·»åŠ dogï¼Œpigï¼Œåˆ™æ­¤åˆ—è¡¨ä¸­å°±æœ‰ä¸‰ä¸ªå…ƒç´ </p>
<p>lrange list 0 -1 è¾“å‡ºåˆ—è¡¨ä¸­çš„å…ƒç´ ï¼Œå¦‚ä¸Šçš„è¯åˆ™ä¸ºpig dog cat</p>
<p>rpush list duck å¾€åˆ—è¡¨å³ä¾§æ·»åŠ ä¸€ä¸ªå…ƒç´ </p>
<p>lpop listç§»é™¤listé˜Ÿåˆ—å·¦ä¾§ç¬¬ä¸€ä¸ªå…ƒç´ </p>
<p>rpop listç§»é™¤listå³ä¾§ç¬¬ä¸€ä¸ªå…ƒç´ </p>
<p>lindex list 1 è·å–listä¸­ä¸‹æ ‡ä¸º1çš„å…ƒç´ </p>
<p>llen list è·å–åˆ—è¡¨é•¿åº¦</p>
<p>lrem list 1 cat ç§»é™¤listä¸­ä¸€ä¸ªcat ï¼Œ1ä¸ºç§»é™¤çš„ä¸ªæ•°</p>
<p>ltrim list n1 n2 é˜¶æ®µlistä¸ºn1,n2ä¸­é—´çš„å…ƒç´ ï¼Œé—­åŒºé—´</p>
<p>rpoplpush list1  list2 æŠŠlist1ä¸­çš„æœ€å³è¾¹ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°list2æœ€å·¦è¾¹</p>
<p>lset list 0 item å°†liståˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡å¤„çš„å€¼æ›´æ–°ä¸ºæŒ‡å®šå€¼ï¼Œå¦‚æœä¸å­˜åœ¨åˆ—è¡¨æˆ–ä¸‹æ ‡è¶Šç•Œå°†ä¼šæŠ¥é”™</p>
<p>linsert list before v2 nv å¾€v2çš„å·¦ä¾§æ’å…¥ä¸€ä¸ªnvï¼ŒåŒæ ·ä¹Ÿæœ‰afteræ’å…¥</p>
<p><strong>ä¸€äº›åº”ç”¨</strong></p>
<p>æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”Ÿäº§è€…æ¶ˆè´¹è€…ç­‰</p>
<h4 id="seté›†åˆ"><a href="#seté›†åˆ" class="headerlink" title="seté›†åˆ"></a>seté›†åˆ</h4><p>Redis çš„ Set æ˜¯ String ç±»å‹çš„æ— åºé›†åˆã€‚é›†åˆæˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œè¿™å°±æ„å‘³ç€é›†åˆä¸­ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®ã€‚é›†åˆå¯¹è±¡çš„ç¼–ç å¯ä»¥æ˜¯ intset æˆ–è€… hashtableã€‚Redis ä¸­é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚</p>
<p><strong>åŸºæœ¬ç”¨æ³•</strong></p>
<p>æ­¤å¤„seté›†åˆåå³ä¸ºkeyå€¼</p>
<p>sadd myset hello å¾€mysetä¸­å­˜å…¥hello</p>
<p>smembers myset åˆ—å‡ºmysetä¸­æ‰€æœ‰å€¼</p>
<p>sismember myset hello æŸ¥è¯¢mysetä¸­æ˜¯å¦å«æœ‰helloè¿™ä¸ªå€¼ï¼Œæœ‰è¿”å›1ï¼Œæ— 0</p>
<p>scard myset è·å–å…ƒç´ ä¸ªæ•°</p>
<p>srem myset hello åˆ é™¤hello</p>
<p>spop myset éšæœºåˆ é™¤ä¸€ä¸ªå…ƒç´ </p>
<p>srandmember  mysetä»æŒ‡å®šé›†åˆä¸­éšæœºæŠ½å–ä¸€ä¸ªå…ƒç´ </p>
<p>smove myset myset2  â€œhelloâ€ å°†mysetä¸­helloå…ƒç´ ç§»åŠ¨åˆ°myset2ä¸­</p>
<p>sdiff set1 set2 æŸ¥è¯¢set1ä¸set2çš„å·®é›†</p>
<p>sinter set1 set2 äº¤é›†(å…±åŒå…³æ³¨<span class="github-emoji"><span>ğŸ˜„</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> )</p>
<p>sunion set1 set2 å¹¶é›†</p>
<h4 id="Hashå“ˆå¸Œ"><a href="#Hashå“ˆå¸Œ" class="headerlink" title="Hashå“ˆå¸Œ"></a>Hashå“ˆå¸Œ</h4><p>Redis hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ fieldï¼ˆå­—æ®µï¼‰ å’Œ valueï¼ˆå€¼ï¼‰ çš„æ˜ å°„è¡¨ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ï¼Œå°±åƒmapã€‚</p>
<p><strong>åŸºæœ¬ç”¨æ³•</strong></p>
<p>hset myhash name rainskyå°†name-&gt;rainskyé”®å€¼å¯¹ï¼ˆå“ˆå¸Œå€¼ï¼‰å­˜å…¥myhashè¿™ä¸ªå“ˆå¸Œè¡¨</p>
<p>hget myhash name ä»myhashä¸­è·å–keyä¸ºnameçš„value</p>
<p>hmset myhash name rainsky age 18 å­˜å…¥å¤šä¸ªå“ˆå¸Œå€¼</p>
<p>hmget myhash name age è·å–å“ˆå¸Œè¡¨ä¸­å¤šä¸ªkeyå¯¹åº”çš„valueå€¼</p>
<p>hgetall myhash è·å–æ‰€æœ‰å“ˆå¸Œå€¼ï¼Œç»“æœä»¥keyæ¢è¡Œvalueæ¢è¡Œkeyæ¢è¡Œvalueæ¢è¡Œâ€¦æ˜¾ç¤º</p>
<p>hdel myhash name åˆ é™¤myhashå“ˆå¸Œè¡¨ä¸­nameå¯¹åº”çš„å“ˆå¸Œå€¼</p>
<p>hlen myhash è·å–å“ˆå¸Œè¡¨å“ˆå¸Œå€¼ä¸ªæ•°</p>
<p>exists myhash nameåˆ¤æ–­nameä¸ºkeyçš„å“ˆå¸Œå€¼æ˜¯å¦å­˜åœ¨äºmyhashä¸­</p>
<p>hkeys myhashè·å–æ‰€æœ‰key</p>
<p>hvals myhashè·å–æ‰€æœ‰value</p>
<p>hincrby myhash age  1 è®©ageå¯¹åº”valueè‡ªå¢1</p>
<p>hsetnx myhash name rain å½“æ­¤å“ˆå¸Œå€¼ä¸å­˜åœ¨æ—¶æ’å…¥æŒ‡å®šå“ˆå¸Œå€¼</p>
<h4 id="zsetæœ‰åºé›†åˆ"><a href="#zsetæœ‰åºé›†åˆ" class="headerlink" title="zsetæœ‰åºé›†åˆ"></a>zsetæœ‰åºé›†åˆ</h4><p>Redis æœ‰åºé›†åˆå’Œé›†åˆä¸€æ ·ä¹Ÿæ˜¯ string ç±»å‹å…ƒç´ çš„é›†åˆ,ä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚</p>
<p>ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ª double ç±»å‹çš„åˆ†æ•°ã€‚redis æ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚ é›†åˆä¸­æœ€å¤§çš„æˆå‘˜æ•°ä¸º 232 - 1 (4294967295, æ¯ä¸ªé›†åˆå¯å­˜å‚¨40å¤šäº¿ä¸ªæˆå‘˜)ã€‚</p>
<p><strong>åŸºæœ¬ç”¨æ³•</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 1 redis åˆ†æ•°ä¸º1å¤„å…ƒç´ ä¸ºredis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 2 mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 3 mysql</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 3 mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 4 mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; ZRANGE runoobkey 0 10 WITHSCORES è¾“å‡ºzsetä¸­scoreå†0-10åŒºé—´çš„å†…å®¹å¹¶æŠŠscoreè¿å¸¦å‡åºè¾“å‡º</span><br><span class="line"></span><br><span class="line">1) "redis"</span><br><span class="line">2) "1"</span><br><span class="line">3) "mongodb"</span><br><span class="line">4) "2"</span><br><span class="line">5) "mysql"</span><br><span class="line">6) "4"</span><br><span class="line"></span><br><span class="line">zrem runoobkey redis ç§»é™¤ä¸€ä¸ªæŒ‡å®šå…ƒç´ </span><br><span class="line">zcard runoobkey æŸ¥çœ‹å…ƒç´ ä¸ªæ•°</span><br><span class="line">zrevrange myzset é™åºæ’åºï¼Œé»˜è®¤æ˜¯å‡åº</span><br><span class="line">zcount myset n1 n2è·å–n1 n2åŒºé—´çš„å…ƒç´ ä¸ªæ•°</span><br><span class="line">zrangebyscore myzset -inf +inf å°†zsetä¸­å…ƒç´ æŒ‰scoreæ’åºï¼ŒscoreèŒƒå›´ä¸º-infåˆ°+inf</span><br></pre></td></tr></tbody></table></figure>

<p>å¯ä»¥æœ‰ä»€ä¹ˆåº”ç”¨å‘¢ï¼Ÿ</p>
<p>å­˜å‚¨å¸¦æƒé‡ï¼ˆscoreï¼‰çš„æ•°æ®ï¼Œç„¶åæ’åºï¼Œå¦‚å„ç§æ’è¡Œæ¦œã€‚</p>
<h3 id="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"><a href="#ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹" class="headerlink" title="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"></a>ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</h3><h4 id="geospatialåœ°ç†ä½ç½®"><a href="#geospatialåœ°ç†ä½ç½®" class="headerlink" title="geospatialåœ°ç†ä½ç½®"></a>geospatialåœ°ç†ä½ç½®</h4><p>å°†æŒ‡å®šçš„åœ°ç†ç©ºé—´ä½ç½®ï¼ˆçº¬åº¦ã€ç»åº¦ã€åç§°ï¼‰æ·»åŠ åˆ°æŒ‡å®šçš„keyä¸­ã€‚è¿™äº›æ•°æ®å°†ä¼šå­˜å‚¨åˆ°sorted setè¿™æ ·çš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨GEORADIUSæˆ–è€…GEORADIUSBYMEMBERå‘½ä»¤å¯¹æ•°æ®è¿›è¡ŒåŠå¾„æŸ¥è¯¢ç­‰æ“ä½œã€‚</p>
<ul>
<li>æœ‰æ•ˆçš„ç»åº¦ä»-180åº¦åˆ°180åº¦ã€‚</li>
<li>æœ‰æ•ˆçš„çº¬åº¦ä»-85.05112878åº¦åˆ°85.05112878åº¦ã€‚</li>
</ul>
<p>å½“åæ ‡ä½ç½®è¶…å‡ºä¸Šè¿°æŒ‡å®šèŒƒå›´æ—¶ï¼Œè¯¥å‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p><strong>ç›¸å…³æŒ‡ä»¤</strong></p>
<p>groaddï¼šå°†æŒ‡å®šçš„åœ°ç†ç©ºé—´ä½ç½®ï¼ˆçº¬åº¦ã€ç»åº¦ã€åç§°ï¼‰æ·»åŠ åˆ°æŒ‡å®šçš„keyä¸­ã€‚</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å°†åŸå¸‚ä¿¡æ¯æ·»åŠ è¿›cityä¸­ï¼Œä¸¤ä¸ªæ•°å­—åˆ†åˆ«å¯¹åº”ç»´åº¦ï¼Œç»åº¦ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨åç§°</span></span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOADD city 13.361389 38.115556 <span class="string">"Palermo"</span> 15.087269 37.502669 <span class="string">"Catania"</span></span></span><br><span class="line">(integer) 2</span><br></pre></td></tr></tbody></table></figure>

<p>gropopsï¼šä»keyé‡Œè¿”å›æ‰€æœ‰ç»™å®šä½ç½®å…ƒç´ çš„ä½ç½®ï¼ˆç»åº¦å’Œçº¬åº¦ï¼‰ã€‚GEOPOS å‘½ä»¤è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ æ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹éƒ½ç”±ä¸¤ä¸ªå…ƒç´ ç»„æˆï¼š ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºç»™å®šä½ç½®å…ƒç´ çš„ç»åº¦ï¼Œ è€Œç¬¬äºŒä¸ªå…ƒç´ åˆ™ä¸ºç»™å®šä½ç½®å…ƒç´ çš„çº¬åº¦ã€‚</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOPOS city Palermo Catania NonExisting</span></span><br><span class="line">1) 1) "13.361389338970184"</span><br><span class="line">   2) "38.115556395496299"</span><br><span class="line">2) 1) "15.087267458438873"</span><br><span class="line">   2) "37.50266842333162"</span><br><span class="line">3) (nil)</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> </span></span><br></pre></td></tr></tbody></table></figure>

<p>GEODISTï¼šå‘½ä»¤ - è¿”å›ä¸¤ä¸ªç»™å®šä½ç½®ä¹‹é—´çš„è·ç¦»</p>
<p>æŒ‡å®šå•ä½çš„å‚æ•° unit å¿…é¡»æ˜¯ä»¥ä¸‹å•ä½çš„å…¶ä¸­ä¸€ä¸ªï¼š</p>
<ul>
<li><strong>m</strong> è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚</li>
<li><strong>km</strong> è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚</li>
<li><strong>mi</strong> è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚</li>
<li><strong>ft</strong> è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚</li>
</ul>
<p>å¦‚æœç”¨æˆ·æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šå•ä½å‚æ•°ï¼Œ é‚£ä¹ˆ <code>GEODIST</code> é»˜è®¤ä½¿ç”¨ç±³ä½œä¸ºå•ä½ã€‚</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOADD Sicily 13.361389 38.115556 <span class="string">"Palermo"</span> 15.087269 37.502669 <span class="string">"Catania"</span></span></span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEODIST Sicily Palermo Catania</span></span><br><span class="line">"166274.15156960039"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEODIST Sicily Palermo Catania km</span></span><br><span class="line">"166.27415156960038"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEODIST Sicily Palermo Catania mi</span></span><br><span class="line">"103.31822459492736"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEODIST Sicily Foo Bar</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> </span></span><br></pre></td></tr></tbody></table></figure>

<p>GEORADIUS: å‘½ä»¤ - ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ </p>
<ul>
<li><code>WITHDIST</code>: åœ¨è¿”å›ä½ç½®å…ƒç´ çš„åŒæ—¶ï¼Œ å°†ä½ç½®å…ƒç´ ä¸ä¸­å¿ƒä¹‹é—´çš„è·ç¦»ä¹Ÿä¸€å¹¶è¿”å›ã€‚ è·ç¦»çš„å•ä½å’Œç”¨æˆ·ç»™å®šçš„èŒƒå›´å•ä½ä¿æŒä¸€è‡´ã€‚</li>
<li><code>WITHCOORD</code>: å°†ä½ç½®å…ƒç´ çš„ç»åº¦å’Œç»´åº¦ä¹Ÿä¸€å¹¶è¿”å›ã€‚</li>
</ul>
<p>å‘½ä»¤é»˜è®¤è¿”å›æœªæ’åºçš„ä½ç½®å…ƒç´ ã€‚ é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°ï¼Œ ç”¨æˆ·å¯ä»¥æŒ‡å®šè¢«è¿”å›ä½ç½®å…ƒç´ çš„æ’åºæ–¹å¼ï¼š</p>
<ul>
<li><code>ASC</code>: æ ¹æ®ä¸­å¿ƒçš„ä½ç½®ï¼Œ æŒ‰ç…§ä»è¿‘åˆ°è¿œçš„æ–¹å¼è¿”å›ä½ç½®å…ƒç´ ã€‚</li>
<li><code>DESC</code>: æ ¹æ®ä¸­å¿ƒçš„ä½ç½®ï¼Œ æŒ‰ç…§ä»è¿œåˆ°è¿‘çš„æ–¹å¼è¿”å›ä½ç½®å…ƒç´ ã€‚</li>
</ul>
<p>è¿”å›å€¼<br>åœ¨æ²¡æœ‰ç»™å®šä»»ä½• WITH é€‰é¡¹çš„æƒ…å†µä¸‹ï¼Œ å‘½ä»¤åªä¼šè¿”å›ä¸€ä¸ªåƒ [â€œNew Yorkâ€,â€Milanâ€,â€Parisâ€] è¿™æ ·çš„çº¿æ€§ï¼ˆlinearï¼‰åˆ—è¡¨ã€‚<br>åœ¨æŒ‡å®šäº† WITHCOORD ã€ WITHDIST ã€ WITHHASH ç­‰é€‰é¡¹çš„æƒ…å†µä¸‹ï¼Œ å‘½ä»¤è¿”å›ä¸€ä¸ªäºŒå±‚åµŒå¥—æ•°ç»„ï¼Œ å†…å±‚çš„æ¯ä¸ªå­æ•°ç»„å°±è¡¨ç¤ºä¸€ä¸ªå…ƒç´ ã€‚<br>åœ¨è¿”å›åµŒå¥—æ•°ç»„æ—¶ï¼Œ å­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ€»æ˜¯ä½ç½®å…ƒç´ çš„åå­—ã€‚ è‡³äºé¢å¤–çš„ä¿¡æ¯ï¼Œ åˆ™ä¼šä½œä¸ºå­æ•°ç»„çš„åç»­å…ƒç´ ï¼Œ æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¢«è¿”å›ï¼š</p>
<p>ä»¥æµ®ç‚¹æ•°æ ¼å¼è¿”å›çš„ä¸­å¿ƒä¸ä½ç½®å…ƒç´ ä¹‹é—´çš„è·ç¦»ï¼Œ å•ä½ä¸ç”¨æˆ·æŒ‡å®šèŒƒå›´æ—¶çš„å•ä½ä¸€è‡´ã€‚<br>geohash æ•´æ•°ã€‚<br>ç”±ä¸¤ä¸ªå…ƒç´ ç»„æˆçš„åæ ‡ï¼Œåˆ†åˆ«ä¸ºç»åº¦å’Œçº¬åº¦ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œ GEORADIUS Sicily 15 37 200 km WITHCOORD WITHDIST è¿™æ ·çš„å‘½ä»¤è¿”å›çš„æ¯ä¸ªå­æ•°ç»„éƒ½æ˜¯ç±»ä¼¼ä»¥ä¸‹æ ¼å¼çš„ï¼š</p>
<p>[â€œPalermoâ€,â€190.4424â€,[â€œ13.361389338970184â€,â€38.115556395496299â€]]</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOADD Sicily 13.361389 38.115556 <span class="string">"Palermo"</span> 15.087269 37.502669 <span class="string">"Catania"</span></span></span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEORADIUS Sicily 15 37 200 km WITHDIST</span></span><br><span class="line">1) 1) "Palermo"</span><br><span class="line">   2) "190.4424"</span><br><span class="line">2) 1) "Catania"</span><br><span class="line">   2) "56.4413"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEORADIUS Sicily 15 37 200 km WITHCOORD</span></span><br><span class="line">1) 1) "Palermo"</span><br><span class="line">   2) 1) "13.361389338970184"</span><br><span class="line">      2) "38.115556395496299"</span><br><span class="line">2) 1) "Catania"</span><br><span class="line">   2) 1) "15.087267458438873"</span><br><span class="line">      2) "37.50266842333162"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEORADIUS Sicily 15 37 200 km WITHDIST WITHCOORD</span></span><br><span class="line">1) 1) "Palermo"</span><br><span class="line">   2) "190.4424"</span><br><span class="line">   3) 1) "13.361389338970184"</span><br><span class="line">      2) "38.115556395496299"</span><br><span class="line">2) 1) "Catania"</span><br><span class="line">   2) "56.4413"</span><br><span class="line">   3) 1) "15.087267458438873"</span><br><span class="line">      2) "37.50266842333162"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> </span></span><br></pre></td></tr></tbody></table></figure>

<p> GEOHASH å‘½ä»¤ - è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å…ƒç´ çš„ Geohash è¡¨ç¤º</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOADD Sicily 13.361389 38.115556 <span class="string">"Palermo"</span> 15.087269 37.502669 <span class="string">"Catania"</span></span></span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOHASH Sicily Palermo Catania</span></span><br><span class="line">1) "sqc8b49rny0"</span><br><span class="line">2) "sqdtr74hyu0"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> </span></span><br></pre></td></tr></tbody></table></figure>

<p>GEORADIUSBYMEMBER å‘½ä»¤ - æ‰¾å‡ºä½äºæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼Œä¸­å¿ƒç‚¹æ˜¯ç”±ç»™å®šçš„ä½ç½®å…ƒç´ å†³å®š</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOADD Sicily 13.583333 37.316667 <span class="string">"Agrigento"</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEOADD Sicily 13.361389 38.115556 <span class="string">"Palermo"</span> 15.087269 37.502669 <span class="string">"Catania"</span></span></span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GEORADIUSBYMEMBER Sicily Agrigento 100 km</span></span><br><span class="line">1) "Agrigento"</span><br><span class="line">2) "Palermo"</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> </span></span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>geoåº•å±‚å°±æ˜¯zset</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡ºgeoæœªç»™å‡ºç§»é™¤å…ƒç´ apiï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨zremæ¥æ“ä½œ</p>
<p>å¦‚ï¼šzrange Sicily -inf +inf åˆ—å‡ºæ‰€æœ‰åŸå¸‚åç§°ï¼Œzrem Sicily Palermo åˆ é™¤ä¸€ä¸ªåŸå¸‚</p>
<h4 id="Hyperloglog"><a href="#Hyperloglog" class="headerlink" title="Hyperloglog"></a>Hyperloglog</h4><p>Redis åœ¨ 2.8.9 ç‰ˆæœ¬æ·»åŠ äº† HyperLogLog ç»“æ„ã€‚</p>
<p>Redis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®š çš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚</p>
<blockquote>
<p>ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ</p>
</blockquote>
<p>æ¯”å¦‚æ•°æ®é›† {1, 3, 5, 7, 5, 7, 8}ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º {1, 3, 5 ,7, 8}, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚ åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚</p>
<p><strong>åŸºæœ¬ç”¨æ³•</strong><br>pfadd mypf  1 2 3 4 5 6 7åŠ å…¥æ•°æ®é›†</p>
<p>pfadd yourpf 1 2 4 8 9</p>
<p>pcount mypf è®¡ç®—åŸºæ•°</p>
<p>pfmerge  all mypf yourpf å°†mypfï¼Œyourpfåˆå¹¶ä¸ºall</p>
<h4 id="Bitmaps"><a href="#Bitmaps" class="headerlink" title="Bitmaps"></a>Bitmaps</h4><p>Redisæä¾›çš„Bitmapsè¿™ä¸ªâ€œæ•°æ®ç»“æ„â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œã€‚Bitmapsæœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®é™…ä¸Šå°±æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚</p>
<p>å¯ä»¥æŠŠBitmapsæƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜0æˆ–è€…1ï¼Œæ•°ç»„çš„ä¸‹æ ‡åœ¨bitmapsä¸­å«åšåç§»é‡ã€‚å•ä¸ªbitmapsçš„æœ€å¤§é•¿åº¦æ˜¯512MBï¼Œå³2^32ä¸ªæ¯”ç‰¹ä½ã€‚<br><strong>åŸºæœ¬æ“ä½œ</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> setbit key 10 1</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> getbit key 10</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> getbit key 11</span></span><br><span class="line">(integer) 0</span><br><span class="line">-----------------------------</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> setbit key 0 1</span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> setbit key 100 1</span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> bitcount key</span></span><br><span class="line">(integer) 2</span><br></pre></td></tr></tbody></table></figure>



<h3 id="redisäº‹åŠ¡"><a href="#redisäº‹åŠ¡" class="headerlink" title="redisäº‹åŠ¡"></a>redisäº‹åŠ¡</h3><p><strong>å¼•è¨€</strong></p>
<blockquote>
<p>åœ¨æ•°æ®åº“ç›¸å…³ç†è®ºä¸­ï¼Œä¸€ä¸ªé€»è¾‘å·¥ä½œå•å…ƒæƒ³è¦æˆä¸ºäº‹åŠ¡ï¼Œå°±å¿…é¡»æ»¡è¶³<strong>ACID</strong>ï¼Œå³åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ã€‚</p>
<ul>
<li>(1)åŸå­æ€§ï¼šåŸå­æ€§è¿™ä¸ªæ¦‚å¿µå…¶å®å°±æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡å†…çš„æ‰€æœ‰SQLæ“ä½œéƒ½æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå› æ­¤åªæœ‰æ‰€æœ‰çš„SQLæ“ä½œéƒ½å®Œå…¨æ‰§è¡ŒæˆåŠŸï¼Œè¯¥äº‹åŠ¡æ–¹å¯ä»¥è®¤ä¸ºæäº¤æˆåŠŸã€‚å¦‚æœåœ¨æäº¤äº‹åŠ¡è¿‡ç¨‹ä¸­æŸä¸€æ¡SQLè¯­å¥æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ•´ä¸ªäº‹åŠ¡å¿…é¡»å›æ»šåˆ°äº‹åŠ¡æäº¤å‰çš„çŠ¶æ€ã€‚</li>
<li>(2)ä¸€è‡´æ€§ï¼šè€Œä¸€è‡´æ€§è¿™ä¸ªæ¦‚å¿µåˆ™æ˜¯æŒ‡ï¼Œäº‹åŠ¡åœ¨å®Œæˆçš„æ—¶å€™ï¼Œå¿…é¡»è¦ä¿è¯æ‰€æœ‰çš„æ•°æ®éƒ½ä¿æŒä¸€è‡´çš„çŠ¶æ€ï¼Œè€Œè½å®åˆ°æ•°æ®åº“çš„å„ä¸ªç»„æˆéƒ¨åˆ†ä¸Šï¼Œåˆ™è¦æ±‚å¼€å‘äººå‘˜èƒ½å¤Ÿä¿è¯æ•°æ®ã€ç´¢å¼•ã€çº¦æŸã€æ—¥å¿—ç­‰åœ¨äº‹åŠ¡å‰åå…·å¤‡ä¸€è‡´æ€§ã€‚</li>
<li>(3)éš”ç¦»æ€§ï¼šéš”ç¦»æ€§è¿™ä¸ªæ¦‚å¿µä¸»è¦é’ˆå¯¹å¹¶å‘ï¼Œå…¶æ ¸å¿ƒæ€æƒ³å°±æ˜¯ä¸åŒçš„å¹¶å‘äº‹åŠ¡å¯¹æ•°æ®äº§ç”Ÿçš„ä¿®æ”¹å¿…é¡»æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªä¸åŒçš„äº‹åŠ¡Aå’ŒBå¹¶å‘æ‰§è¡Œï¼Œé‚£ä¹ˆå¯¹Aæ¥è®²ï¼Œå®ƒåœ¨æ‰§è¡Œå‰çš„çŠ¶æ€åªæœ‰ä¸¤ç§ï¼Œå³Bæ‰§è¡Œå‰å’ŒBæ‰§è¡Œåã€‚åŒç†ï¼Œå¯¹Bæ¥è®²åŒæ ·æ˜¯å¦‚æ­¤ï¼Œè¿™æ ·çš„ç‰¹æ€§æˆ‘ä»¬å°±ç§°ä¸ºéš”ç¦»æ€§ã€‚</li>
<li>(4)æŒä¹…æ€§ï¼šæŒä¹…æ€§ç›¸å¯¹ç®€å•ï¼Œæ˜¯æŒ‡äº‹åŠ¡å®Œæˆä»¥åå®ƒå¯¹æ•°æ®çš„å½±å“æ˜¯æ°¸ä¹…æ€§çš„ã€‚</li>
</ul>
</blockquote>
<h4 id="redisäº‹åŠ¡å¤„ç†"><a href="#redisäº‹åŠ¡å¤„ç†" class="headerlink" title="redisäº‹åŠ¡å¤„ç†"></a>redisäº‹åŠ¡å¤„ç†</h4><p><strong>redisäº‹åŠ¡ä»‹ç»</strong></p>
<ol>
<li>Redis çš„äº‹åŠ¡æ˜¯é€šè¿‡ <strong>MULTIï¼ŒEXECï¼ŒDISCARD å’Œ WATCH</strong> è¿™å››ä¸ªå‘½ä»¤æ¥å®Œæˆçš„ã€‚</li>
<li>Redis çš„å•ä¸ªå‘½ä»¤éƒ½æ˜¯<strong>åŸå­æ€§</strong>çš„ï¼Œæ‰€ä»¥è¿™é‡Œç¡®ä¿äº‹åŠ¡æ€§çš„å¯¹è±¡æ˜¯<strong>å‘½ä»¤é›†åˆ</strong>ã€‚</li>
<li>Redis å°†å‘½ä»¤é›†åˆåºåˆ—åŒ–å¹¶ç¡®ä¿å¤„äºåŒä¸€äº‹åŠ¡çš„<strong>å‘½ä»¤é›†åˆè¿ç»­ä¸”ä¸è¢«æ‰“æ–­</strong>çš„æ‰§è¡Œ</li>
<li>Redisä¸æ”¯æŒå›æ»šæ“ä½œ</li>
</ol>
<p>æ€è€ƒï¼šä¸ºä»€ä¹ˆ Redis ä¸æ”¯æŒäº‹åŠ¡å›æ»šï¼Ÿ</p>
<ul>
<li>å¤§å¤šæ•°äº‹åŠ¡å¤±è´¥æ˜¯å› ä¸º<strong>è¯­æ³•é”™è¯¯æˆ–è€…ç±»å‹é”™è¯¯</strong>ï¼Œè¿™ä¸¤ç§é”™è¯¯ï¼Œåœ¨å¼€å‘é˜¶æ®µéƒ½æ˜¯å¯ä»¥é¢„è§çš„ã€‚</li>
<li>Redis ä¸ºäº†<strong>æ€§èƒ½æ–¹é¢</strong>å°±å¿½ç•¥äº†äº‹åŠ¡å›æ»šã€‚</li>
</ul>
<blockquote>
<p>å•ä¸ª Redis å‘½ä»¤çš„æ‰§è¡Œæ˜¯åŸå­æ€§çš„ï¼Œä½† Redis æ²¡æœ‰åœ¨äº‹åŠ¡ä¸Šå¢åŠ ä»»ä½•ç»´æŒåŸå­æ€§çš„æœºåˆ¶ï¼Œæ‰€ä»¥ Redis äº‹åŠ¡çš„æ‰§è¡Œå¹¶ä¸æ˜¯åŸå­æ€§çš„ã€‚</p>
</blockquote>
<p><strong>äº‹åŠ¡å¤„ç†å‘½ä»¤</strong></p>
<p>äº‹åŠ¡å¤„ç†å‘½ä»¤ä¼šåƒéäº‹åŠ¡çŠ¶æ€ä¸‹ä¸€æ ·è¢«ç«‹åˆ»æ‰§è¡Œ</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802120751.jpeg"></p>
<p><strong>äº‹åŠ¡å¤„ç†æµç¨‹</strong></p>
<p>ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>1ï¼‰å¼€å§‹äº‹åŠ¡ã€‚ï¼ˆéäº‹åŠ¡çŠ¶æ€-&gt;äº‹åŠ¡çŠ¶æ€ï¼‰</li>
<li>2ï¼‰å‘½ä»¤å…¥é˜Ÿã€‚ï¼ˆå¹¶ä¸æ‰§è¡Œï¼‰</li>
<li>3ï¼‰æ‰§è¡Œäº‹åŠ¡ã€‚</li>
</ul>
<p>ä¸€ä¸ªç®€å•äº‹åŠ¡ç¤ºä¾‹</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI </span><br><span class="line">OK </span><br><span class="line">127.0.0.1:6379&gt; SET Book_Name "GIt Pro" </span><br><span class="line">QUEUED </span><br><span class="line">127.0.0.1:6379&gt; SADD Program_Language "C++" "C#" "Jave" "Python"  </span><br><span class="line">QUEUED </span><br><span class="line">127.0.0.1:6379&gt; GET Book_Name </span><br><span class="line">QUEUED </span><br><span class="line">127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK</span><br><span class="line">2) (integer) 4 </span><br><span class="line">3) "GIt Pro" </span><br></pre></td></tr></tbody></table></figure>

<h4 id="äº‹åŠ¡å¤„ç†æƒ…å†µç¤ºä¾‹"><a href="#äº‹åŠ¡å¤„ç†æƒ…å†µç¤ºä¾‹" class="headerlink" title="äº‹åŠ¡å¤„ç†æƒ…å†µç¤ºä¾‹"></a>äº‹åŠ¡å¤„ç†æƒ…å†µç¤ºä¾‹</h4><p>æ”¾å¼ƒäº‹åŠ¡</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802145006.jpeg"></p>
<p>å‘½ä»¤æ€§é”™è¯¯ï¼Œæ‰€æœ‰å‘½ä»¤å‡ä¸ä¼šæ‰§è¡Œ</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802145320.png"></p>
<p>è¿è¡Œæ—¶é”™è¯¯ï¼Œå…¶ä»–å‘½ä»¤ä¾ç„¶æ‰§è¡Œ</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802145525.png"></p>
<h4 id="rediså®ç°ä¹è§‚é”"><a href="#rediså®ç°ä¹è§‚é”" class="headerlink" title="rediså®ç°ä¹è§‚é”"></a>rediså®ç°ä¹è§‚é”</h4><p><strong>æ‚²è§‚é”</strong></p>
<p>æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ï¼ˆ<strong>å…±äº«èµ„æºæ¯æ¬¡åªç»™ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œå…¶å®ƒçº¿ç¨‹é˜»å¡ï¼Œç”¨å®Œåå†æŠŠèµ„æºè½¬è®©ç»™å…¶å®ƒçº¿ç¨‹</strong>ï¼‰ã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚Javaä¸­synchronizedå’ŒReentrantLockç­‰ç‹¬å é”å°±æ˜¯æ‚²è§‚é”æ€æƒ³çš„å®ç°ã€‚</p>
<p><strong>ä¹è§‚é”</strong></p>
<p>æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶å’ŒCASç®—æ³•å®ç°ã€‚<strong>ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡</strong>ï¼Œåƒæ•°æ®åº“æä¾›çš„ç±»ä¼¼äº<strong>write_conditionæœºåˆ¶</strong>ï¼Œå…¶å®éƒ½æ˜¯æä¾›çš„ä¹è§‚é”ã€‚åœ¨Javaä¸­java.util.concurrent.atomicåŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼<strong>CAS</strong>å®ç°çš„ã€‚</p>
<p><strong>rediså®ç°ä¹è§‚é”</strong></p>
<p>ä½¿ç”¨watchå¯¹æ•°æ®åŠ é”ï¼Œå½“æ‰§è¡Œäº‹åŠ¡æœŸé—´ï¼Œè¢«åŠ é”æ•°æ®æœªèƒŒä¿®æ”¹åˆ™äº‹åŠ¡å¯æˆåŠŸæ‰§è¡Œï¼Œå¦åˆ™æ‰§è¡Œå¤±è´¥</p>
<p>å…ˆåœ¨ä¸€ä¸ªè¿æ¥ï¼ˆå‡è®¾ä¸ºçº¿ç¨‹1ï¼‰é‡Œç¼–å†™ä¸€ä¸ªäº‹åŠ¡ï¼Œ</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set money 100</span><br><span class="line">set out 0</span><br><span class="line">multi</span><br><span class="line">decrby money 10</span><br><span class="line">incrby out 10</span><br></pre></td></tr></tbody></table></figure>

<p>è¿˜æœªexecæˆ‘ä»¬å¼€å¯å¦å¤–ä¸€ä¸ªè¿æ¥ï¼ˆå‡è®¾ä¸ºçº¿ç¨‹2ï¼‰ï¼Œç›¸å½“äºå¦å¤–ä¸€ä¸ªç”¨æˆ·ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incrby money 100</span><br></pre></td></tr></tbody></table></figure>

<p>æ‰§è¡Œå®Œæ¯•åæˆ‘ä»¬å›åˆ°çº¿ç¨‹1</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set money 100</span><br><span class="line">set out 0</span><br><span class="line">multi</span><br><span class="line">decrby money 10</span><br><span class="line">incrby out 10</span><br><span class="line">exec</span><br></pre></td></tr></tbody></table></figure>

<p>å½“æˆ‘ä»¬æ‰§è¡Œexecåä¼šæŠ¥é”™ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬æ‰§è¡Œäº‹åŠ¡æœŸé—´ç›‘è§†å€¼moneyå·²ç»è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unwatch æ”¾å¼ƒç›‘è§†</span><br><span class="line">watch money ç›‘è§†moneyæ­¤æ—¶å·²ç»æ˜¯æœ€æ–°å€¼</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>ä¹è§‚é”çš„ä¸€äº›åº”ç”¨ï¼šç§’æ€ç³»ç»Ÿ</p>
</blockquote>
<h2 id="jedis"><a href="#jedis" class="headerlink" title="jedis"></a>jedis</h2><p>Rediså®˜æ–¹æ¨èçš„Javaè¿æ¥å¼€å‘å·¥å…·</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-java.html">å‚è€ƒå­¦ä¹ </a></p>
<p>mavené¡¹ç›®ä½¿ç”¨</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>è¿æ¥åˆ°redis</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisJava</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="comment">//è¿æ¥æœ¬åœ°çš„ Redis æœåŠ¡</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>);</span><br><span class="line">        <span class="comment">// å¦‚æœ Redis æœåŠ¡è®¾ç½®äº†å¯†ç ï¼Œéœ€è¦ä¸‹é¢è¿™è¡Œï¼Œæ²¡æœ‰å°±ä¸éœ€è¦</span></span><br><span class="line">        <span class="comment">// jedis.auth("123456"); </span></span><br><span class="line">        System.out.println(<span class="string">"è¿æ¥æˆåŠŸ"</span>);</span><br><span class="line">        <span class="comment">//æŸ¥çœ‹æœåŠ¡æ˜¯å¦è¿è¡Œ</span></span><br><span class="line">        System.out.println(<span class="string">"æœåŠ¡æ­£åœ¨è¿è¡Œ: "</span>+jedis.ping());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//Stringæ“ä½œ</span></span><br><span class="line">        <span class="comment">//è®¾ç½® redis å­—ç¬¦ä¸²æ•°æ®</span></span><br><span class="line">        jedis.set(<span class="string">"runoobkey"</span>, <span class="string">"www.runoob.com"</span>);</span><br><span class="line">        <span class="comment">// è·å–å­˜å‚¨çš„æ•°æ®å¹¶è¾“å‡º</span></span><br><span class="line">        System.out.println(<span class="string">"redis å­˜å‚¨çš„å­—ç¬¦ä¸²ä¸º: "</span>+ jedis.get(<span class="string">"runoobkey"</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//Listæ“ä½œ</span></span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Runoob"</span>);</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Google"</span>);</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Taobao"</span>);</span><br><span class="line">        <span class="comment">// è·å–å­˜å‚¨çš„æ•°æ®å¹¶è¾“å‡º</span></span><br><span class="line">        List&lt;String&gt; list = jedis.lrange(<span class="string">"site-list"</span>, <span class="number">0</span> ,<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;list.size(); i++) {</span><br><span class="line">            System.out.println(<span class="string">"åˆ—è¡¨é¡¹ä¸º: "</span>+list.get(i));</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        ......</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>ä¸å†èµ˜è¿°ï¼Œæ‰€æœ‰æ“ä½œä¸å‘½ä»¤å‡ç›¸ä¼¼</p>
<blockquote>
<p>ä¸€ä¸ªäº‹åŠ¡çš„æ —å­<span class="github-emoji"><span>ğŸ“</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
</blockquote>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802155721.png"></p>
<h2 id="springbootæ•´åˆredis"><a href="#springbootæ•´åˆredis" class="headerlink" title="springbootæ•´åˆredis"></a>springbootæ•´åˆredis</h2><p>springç³»åˆ—ä¸æ•°æ®æ“ä½œç›¸å…³çš„é¡¹ç›®ä¸ºspring-dataï¼Œ<a target="_blank" rel="noopener" href="https://spring.io/projects/spring-data-redis">å®˜ç½‘</a></p>
<img src="https://gitee.com/rain-sky/images/raw/master/20210802160745.png" style="zoom:50%;">

<p>åœ¨springboot2.xåï¼Œæ“ä½œredisçš„jedisæ›´æ¢ä¸ºlettuceã€‚</p>
<p>jedisï¼šé‡‡ç”¨ç›´è¿ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œçš„è¯ä¸å®‰å…¨ï¼Œéœ€è¦ä½¿ç”¨Jedis  pool ï¼Œç±»ä¼¼BIOæ¨¡å¼ã€‚</p>
<p>lettuceï¼šé‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±äº«ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨æƒ…å†µï¼Œç±»ä¼¼NIOæ¨¡å¼ã€‚</p>
<blockquote>
<p>ä½¿ç”¨</p>
</blockquote>
<p><strong>å¯¼å…¥starter</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>é…ç½®è§£æ</strong></p>
<p>æ‰¾åˆ°è‡ªåŠ¨é…ç½®ç±»ï¼Œå¯ä»¥çœ‹åˆ°ä¸ºæˆ‘ä»¬æ³¨å…¥äº†ä¸¤ä¸ªå¸¸ç”¨ç±»ï¼Œæ–¹æ³•å‚æ•°ä¸ºä¸€ä¸ªredisè¿æ¥å·¥å‚å¯¹è±¡ï¼Œç‚¹è¿›å»å‘ç°æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œæ­¤æ¥å£çš„å®ç°ç±»æœ‰ä¸¤ä¸ªã€‚</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802161509.png"></p>
<p>å®ç°ç±»</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802164132.png"></p>
<p>çœ‹çœ‹ç»‘å®šçš„é…ç½®ç±»ï¼Œæ‰¾åˆ°é…ç½®ç±»ï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›é»˜è®¤é…ç½®</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210802161554.png"></p>
<p><strong>é…ç½®è¿æ¥ç¤ºä¾‹</strong></p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰  </span></span><br><span class="line"><span class="string">spring.redis.database=0</span>  </span><br><span class="line"><span class="comment"># RedisæœåŠ¡å™¨åœ°å€  </span></span><br><span class="line"><span class="string">spring.redis.host=192.168.0.24</span>  </span><br><span class="line"><span class="comment"># RedisæœåŠ¡å™¨è¿æ¥ç«¯å£  </span></span><br><span class="line"><span class="string">spring.redis.port=6379</span>  </span><br><span class="line"><span class="comment"># RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰  </span></span><br><span class="line"><span class="string">spring.redis.password=</span>  </span><br><span class="line"><span class="comment"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰  </span></span><br><span class="line"><span class="string">spring.redis.pool.max-active=200</span>  </span><br><span class="line"><span class="comment"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰  </span></span><br><span class="line"><span class="string">spring.redis.pool.max-wait=-1</span>  </span><br><span class="line"><span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥  </span></span><br><span class="line"><span class="string">spring.redis.pool.max-idle=10</span> </span><br><span class="line"><span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥  </span></span><br><span class="line"><span class="string">spring.redis.pool.min-idle=0</span>  </span><br><span class="line"><span class="comment"># è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰  </span></span><br><span class="line"><span class="string">spring.redis.timeout=1000</span> </span><br></pre></td></tr></tbody></table></figure>

<p><strong>ç®€å•æµ‹è¯•</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootRedisApplicationTests</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">//å¯¹Stringç±»å‹çš„æ“ä½œ</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">"myKey"</span>,<span class="string">"myValue"</span>);</span><br><span class="line">        System.out.println(redisTemplate.opsForValue().get(<span class="string">"myKey"</span>));</span><br><span class="line">        <span class="comment">//å¯¹listçš„æ“ä½œ</span></span><br><span class="line">        redisTemplate.opsForList().leftPush(<span class="string">"hello"</span>,<span class="string">"world!"</span>);</span><br><span class="line">        redisTemplate.opsForList().leftPop(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–è¿æ¥å¯¹è±¡</span></span><br><span class="line">        RedisConnection connection = redisTemplate.getConnectionFactory().getConnection();</span><br><span class="line">        connection.flushAll();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>è‡ªå®šä¹‰RedisTemplate</strong></p>
<p><span class="github-emoji"><span>âš </span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> ç½‘ç»œä¼ è¾“çš„å¯¹è±¡å¿…é¡»åºåˆ—åŒ–</p>
<p>è‡ªå®šä¹‰åºåˆ—åŒ–æ–¹å¼</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803085557.png"></p>
<p>å¾€å¾€ç»“åˆè‡ªå·±æ³¨å…¥çš„RedisTempalteå†è‡ªå®šä¹‰ä¸€ä¸ªrediså·¥å…·ç±»</p>
<h2 id="redis-conf"><a href="#redis-conf" class="headerlink" title="redis.conf"></a>redis.conf</h2><p>rediså¯åŠ¨çš„æ—¶å€™å°±æ˜¯é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶æ¥å¯åŠ¨çš„</p>
<p><span class="github-emoji"><span>1âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0031-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> å­˜å‚¨å•ä½å¯é€‰ï¼Œå¤§å°å†™ä¸æ•æ„Ÿ</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803100112.png"></p>
<p><span class="github-emoji"><span>2âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0032-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>å¼•å…¥å…¶ä»–é…ç½®æ–‡ä»¶</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803100219.png"></p>
<p><span class="github-emoji"><span>3âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0033-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>ç½‘ç»œé…ç½®ï¼Œå‚è§networkéƒ¨åˆ†</p>
<ul>
<li>bind 127.0.0.1 ç»‘å®šçš„ä¸»æœºåœ°å€</li>
</ul>
<p>å…³äºbindï¼Œè¿™ä¸ªé—®é¢˜æ˜¯ç”±äºå¾ˆå¤šæ–‡æ¡£è§£é‡Šbindè€Œå¯¼è‡´çš„è¯¯ä¼šã€‚å¾ˆå¤šåœ°æ–¹ç¿»è¯‘å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>æŒ‡å®šredisåªæ¥æ”¶æ¥è‡ªäºè¯¥IPåœ°å€çš„è¯·æ±‚ï¼Œå¦‚æœä¸è¿›è¡Œè®¾ç½®ï¼Œé‚£ä¹ˆå°†å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æœ€å¥½è®¾ç½®è¯¥é¡¹</p>
</blockquote>
<p>ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œåº”è¯¥bindçš„æ˜¯redisæ‰€åœ¨æœåŠ¡å™¨ç½‘å¡çš„ipã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„redisæœåŠ¡å™¨æœ‰ä¸¤å¼ ç½‘å¡ï¼Œä¸€å¼ æ˜¯ip-1,å¦ä¸€å¼ æ˜¯ip-2ï¼Œå¦‚æœä½ bind ip-1.é‚£ä¹ˆåªæœ‰è¯·æ±‚ip-1çš„è¯·æ±‚ä¼šè¢«å—ç†ã€‚</p>
<ul>
<li>port 6379 æŒ‡å®š Redis ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º 6379ã€‚</li>
</ul>
<p><span class="github-emoji"><span>4âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0034-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>é€šå¸¸é…ç½®</p>
<p>daemonize noï¼šRedis é»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨ yes å¯ç”¨å®ˆæŠ¤è¿›ç¨‹ã€‚</p>
<p>pidfile /var/run/redis_6379.pidï¼šä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œç»‘å®šçš„pidæ–‡ä»¶</p>
<p>loglevel notic ï¼šæŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedis æ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸º notice</p>
<p>logfile â€œâ€ ï¼šæ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½® Redis ä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™ /dev/null</p>
<p>databases 16 ï¼šæ•°æ®åº“ä¸ªæ•°</p>
<p>always-show-logo noï¼šæ˜¯å¦æ˜¾ç¤ºredisçš„logo</p>
<p><span class="github-emoji"><span>5âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0035-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>å¿«ç…§SNAPSHOTTING</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803103030.png"></p>
<p>Redis é»˜è®¤é…ç½®æ–‡ä»¶ä¸­æä¾›äº†ä¸‰ä¸ªæ¡ä»¶ï¼š</p>
<p><strong>save 900 1</strong></p>
<p><strong>save 300 10</strong></p>
<p><strong>save 60 10000</strong></p>
<p>åˆ†åˆ«è¡¨ç¤º 900 ç§’ï¼ˆ15 åˆ†é’Ÿï¼‰å†…æœ‰ 1 ä¸ªæ›´æ”¹ï¼Œ300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰å†…æœ‰ 10 ä¸ªæ›´æ”¹ä»¥åŠ 60 ç§’å†…æœ‰ 10000 ä¸ªæ›´æ”¹ã€‚</p>
<p>æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rdbcompression yes <span class="comment">#æ˜¯å¦å‹ç¼©rdbæ–‡ä»¶</span></span><br><span class="line">stop-writes-on-bgsave-error yes  <span class="comment">#åœ¨ä¿å­˜æ•°æ®åº“æ–‡ä»¶æ—¶å‡ºé”™æ˜¯å¦åœæ­¢å†™å…¥</span></span><br><span class="line">rdbcherksum yes <span class="comment">#rdbæ–‡ä»¶ä¿å­˜æ—¶æ˜¯å¦é”™è¯¯æ£€æŸ¥</span></span><br><span class="line">rdbfilename dump.rdb <span class="comment">#æŒ‡å®šrdbæŒä¹…åŒ–æ–‡ä»¶å</span></span><br><span class="line">dir ./ <span class="comment">#rdbæŒä¹…åŒ–æ–‡ä»¶ä¿å­˜çš„ç›®å½•</span></span><br></pre></td></tr></tbody></table></figure>



<p><span class="github-emoji"><span>6âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0036-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>ä¸»ä»å¤åˆ¶REPLICATION</p>
<p><span class="github-emoji"><span>ğŸš¶</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f6b6.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<p><span class="github-emoji"><span>7âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0037-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>å®‰å…¨SECURITY</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config <span class="built_in">set</span> requirepass <span class="string">"ä½ çš„å¯†ç "</span></span><br><span class="line">config get requirepass è·å–å¯†ç </span><br><span class="line">auth <span class="string">"ä½ çš„å¯†ç "</span> å¯†ç éªŒè¯</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803110057.png"></p>
<p><span class="github-emoji"><span>8âƒ£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/0038-20e3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>APPEND ONLY MODE(AOF)</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é»˜è®¤ä¸å¼€å¯AOF</span></span><br><span class="line">appendonly no</span><br><span class="line"><span class="comment"># The name of the append only file (default: "appendonly.aof")</span></span><br><span class="line">appendfilename <span class="string">"appendonly.aof"</span></span><br><span class="line"><span class="comment">#æ¯ç§’æ‰§è¡Œä¸€æ¬¡sync</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"><span class="comment">#ä¸æ‰§è¡Œsyncï¼Œæ“ä½œç³»ç»Ÿè‡ªä¸»åŒæ­¥æ•°æ®</span></span><br><span class="line">appendfsync no</span><br><span class="line"><span class="comment">#æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsyncï¼Œæ¶ˆè€—æ€§èƒ½</span></span><br><span class="line">appendfsync always</span><br></pre></td></tr></tbody></table></figure>



<h2 id="æŒä¹…åŒ–"><a href="#æŒä¹…åŒ–" class="headerlink" title="æŒä¹…åŒ–"></a>æŒä¹…åŒ–</h2><h3 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h3><p>äº§ç”Ÿä¸€ä¸ªæ•°æ®å¿«ç…§æ–‡ä»¶</p>
<p>RDBæ˜¯Redisç”¨æ¥è¿›è¡ŒæŒä¹…åŒ–çš„ä¸€ç§æ–¹å¼ï¼Œåœ¨æŒ‡å®šæ—¶é—´é—´éš”æŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯ Snapshot å¿«ç…§ï¼ˆæ•°æ®åº“ä¸­æ‰€æœ‰é”®å€¼å¯¹æ•°æ®ï¼‰ã€‚æ¢å¤æ—¶æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803152638.png"></p>
<p>åœ¨rdbæ–¹å¼ä¸­ï¼Œredisä¼šforkä¸€ä¸ªå­è¿›ç¨‹æ¥å°†å†…å­˜ä¸­çš„æ•°æ®å†™å…¥ä¸€ä¸ªä¸´æ—¶rdbæ–‡ä»¶ä¸­ï¼Œå†™å…¥å®Œæˆåä¼šæ›¿æ¢åŸæœ‰rdbæ–‡ä»¶ï¼Œçˆ¶è¿›ç¨‹ä»ç„¶å¯ä»¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚</p>
<p><strong>è§¦å‘è§„åˆ™</strong></p>
<ul>
<li>saveè§„åˆ™æ»¡è¶³æ—¶</li>
<li>flushallæ—¶</li>
<li>é€€å‡ºredisæ—¶</li>
</ul>
<p><strong>æ¢å¤rdbæ–‡ä»¶</strong></p>
<p>åœ¨config get dirç»“æœç›®å½•ä¸‹å­˜åœ¨rdbæ–‡ä»¶å¯åŠ¨æ—¶ä¾¿ä¼šè‡ªåŠ¨åŠ è½½</p>
<p><strong>åˆ©å¼Š</strong></p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ç´§å‡‘å‹å¤‡ä»½æ–‡ä»¶ï¼Œå ç”¨å†…å­˜å°</li>
<li>åœ¨å­è¿›ç¨‹ä¸­å®Œæˆå¤‡ä»½</li>
<li>æ¢å¤å¤§é‡æ•°æ®é›†æ—¶é€Ÿåº¦å¿«</li>
<li>å•æ–‡ä»¶æ˜“äºä¼ è¾“</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å¦‚æœæœåŠ¡å™¨å®•æœºä¼šå‡ºç°æ•°æ®ä¸¢å¤±</li>
<li>æ•°æ®åºå¤§æ—¶ï¼Œforkæ“ä½œè€—æ—¶</li>
</ul>
<h3 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h3><p>Redisçš„å¦å¤–ä¸€ç§æŒä¹…åŒ–æ–¹æ¡ˆå°±æ˜¯AOFï¼ŒAppend Only Fileã€‚AOFç›¸å½“äºä¸€ä¸ªæ“ä½œçš„æ—¥å¿—è®°å½•ï¼Œæ¯æ¬¡å¯¹äºæ•°æ®çš„å˜æ›´ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰éƒ½ä¼šè®°å½•è¿½åŠ åˆ°AOFæ—¥å¿—ã€‚å½“æœåŠ¡å¯åŠ¨çš„æ—¶å€™å°±ä¼šè¯»è¿™äº›æ“ä½œæ—¥å¿—ï¼Œé‡æ–°æ‰§è¡Œä¸€æ¬¡æ“ä½œï¼Œä»è€Œæ¢å¤åŸå§‹æ•°æ®ã€‚</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803154830.png"></p>
<p>åœ¨reids.confä¸­å¯ä»¥çœ‹åˆ°ï¼Œaofæ˜¯é»˜è®¤ä¸å¼€å¯çš„</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é»˜è®¤ä¸å¼€å¯AOF</span></span><br><span class="line">appendonly no</span><br><span class="line"><span class="comment"># The name of the append only file (default: "appendonly.aof")</span></span><br><span class="line">appendfilename <span class="string">"appendonly.aof"</span> <span class="comment">#é»˜è®¤äº§ç”Ÿè®°å½•æ–‡ä»¶ï¼Œè‹¥è¯¥æ–‡ä»¶æŸåï¼Œredisæ— æ³•å¯åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨redis-cherk-aofæ¥ä¿®å¤è¯¥æ–‡ä»¶ï¼Œä½†ä¸èƒ½ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œredis-check-aof --fix appendonly.aof å³å¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¯ç§’æ‰§è¡Œä¸€æ¬¡sync</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"><span class="comment">#ä¸æ‰§è¡Œsyncï¼Œæ“ä½œç³»ç»Ÿè‡ªä¸»åŒæ­¥æ•°æ®</span></span><br><span class="line">appendfsync no</span><br><span class="line"><span class="comment">#æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsyncï¼Œæ¶ˆè€—æ€§èƒ½</span></span><br><span class="line">appendfsync always</span><br><span class="line"></span><br><span class="line">- auto-aof-rewrite-percentage 100 <span class="comment">#å½“æ–‡ä»¶å¢é•¿100%ï¼ˆä¸€å€ï¼‰æ—¶å€™ï¼Œè‡ªåŠ¨é‡å†™ã€‚</span></span><br><span class="line">- auto-aof-rewrite-min-size 64mb <span class="comment">#æ—¥å¿—é‡å†™æœ€å°æ–‡ä»¶å¤§å°ï¼Œå¦‚æœå°äºè¯¥å¤§å°ï¼Œä¸ä¼šè‡ªåŠ¨é‡å†™ã€‚</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>ä¼˜ç¼ºç‚¹</strong></p>
<p>ä¼˜ç‚¹</p>
<ul>
<li>é»˜è®¤æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œæ–‡ä»¶å®Œæ•´æ€§æ›´å¥½</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>aofæ–‡ä»¶ä½“ç§¯å¤§ï¼Œä¿®å¤é€Ÿåº¦æ…¢</li>
<li>å¤§é‡å†™å…¥çš„æ—¶å€™aofæ•ˆç‡ä½</li>
</ul>
<blockquote>
<p>å¦‚ä½•é€‰æ‹©</p>
</blockquote>
<p>ä»¥ä¸Šå·²ç»åŸºæœ¬äº†è§£è¿‡RDBå’ŒAOFçš„ä½¿ç”¨ã€åŸºæœ¬åŸç†ä»¥åŠå¯¹åº”çš„ä¼˜ç¼ºç‚¹ã€‚é‚£ä¹ˆåœ¨å®é™…å½“ä¸­ï¼Œæˆ‘ä»¬åˆ°åº•æ€ä¹ˆå»é€‰æ‹©ç”¨å“ªç§æŒä¹…åŒ–æ–¹å¼å‘¢ï¼Ÿ</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸è€ƒè™‘ç¡¬ç›˜å¤§å°ï¼Œæœ€å®‰å…¨çš„åšæ³•æ˜¯RDBä¸AOFåŒæ—¶ä½¿ç”¨ï¼Œå³ä½¿AOFæŸåæ— æ³•ä¿®å¤ï¼Œè¿˜å¯ä»¥ç”¨RDBæ¥æ¢å¤æ•°æ®ã€‚</p>
<p>å¦‚æœRedisçš„æ•°æ®åœ¨ä½ çš„æœåŠ¡ä¸­å¹¶ä¸æ˜¯å¿…è¦çš„æ•°æ®ï¼Œä¾‹å¦‚åªæ˜¯å½“ç®€å•çš„ç¼“å­˜ï¼Œæ²¡æœ‰ç¼“å­˜ä¹Ÿä¸ä¼šé€ æˆç¼“å­˜é›ªå´©ã€‚è¯´æ˜æ•°æ®çš„å®‰å…¨å¯é æ€§å¹¶ä¸æ˜¯é¦–è¦è€ƒè™‘èŒƒå›´å†…ï¼Œé‚£ä¹ˆå•ç‹¬åªä½¿ç”¨RDBå°±å¯ä»¥äº†ã€‚</p>
<p>ä¸æ¨èå•ç‹¬ä½¿ç”¨AOFï¼Œå› ä¸ºAOFå¯¹äºæ•°æ®çš„æ¢å¤è½½å…¥æ¥è¯´ï¼Œæ¯”RDBæ…¢ã€‚å¹¶ä¸”Rediså®˜æ–¹ä¹Ÿè¯´æ˜äº†ï¼ŒAOFæœ‰ä¸€ä¸ªç½•è§çš„bugã€‚å‡ºäº†é—®é¢˜æ— æ³•å¾ˆå¥½çš„è§£å†³ã€‚æ‰€ä»¥ä½¿ç”¨AOFçš„æ—¶å€™ï¼Œæœ€å¥½è¿˜æ˜¯æœ‰RDBä½œä¸ºæ•°æ®å¤‡ä»½ã€‚</p>
<h2 id="rediså‘å¸ƒè®¢é˜…"><a href="#rediså‘å¸ƒè®¢é˜…" class="headerlink" title="rediså‘å¸ƒè®¢é˜…"></a>rediså‘å¸ƒè®¢é˜…</h2><p>Pub/Sub ä»å­—é¢ä¸Šç†è§£å°±æ˜¯å‘å¸ƒï¼ˆPublishï¼‰ä¸è®¢é˜…ï¼ˆSubscribeï¼‰ï¼Œåœ¨Redisä¸­ï¼Œä½ å¯ä»¥è®¾å®šå¯¹æŸä¸€ä¸ªkeyå€¼è¿›è¡Œæ¶ˆæ¯å‘å¸ƒåŠæ¶ˆæ¯è®¢é˜…ï¼Œå½“ä¸€ä¸ªkeyå€¼ä¸Šè¿›è¡Œäº†æ¶ˆæ¯å‘å¸ƒåï¼Œæ‰€æœ‰è®¢é˜…å®ƒçš„å®¢æˆ·ç«¯éƒ½ä¼šæ”¶åˆ°ç›¸åº”çš„æ¶ˆæ¯ã€‚</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803162718.png"></p>
<p><strong>ç›¸å…³å‘½ä»¤</strong></p>
<p>PSUBSCRIBE pattern [pattern1 â€¦.]</p>
<ul>
<li>è¯´æ˜ï¼šè®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªç¬¦åˆç»™å®šæ¨¡å¼çš„é¢‘é“ï¼Œæ¯ä¸ªæ¨¡å¼ä»¥*ä½œä¸ºåŒ¹é…ç¬¦</li>
<li>å‚æ•°ï¼špattern(ç»™å®šçš„æ¨¡å¼)</li>
<li>è¿”å›ï¼šæ¥å—åˆ°çš„ä¿¡æ¯</li>
</ul>
<p>PUNSUBSCRIBE pattern [pattern1 â€¦.]</p>
<ul>
<li>è¯´æ˜ï¼šç”¨äºé€€è®¢æ‰€æœ‰ç»™å®šæ¨¡å¼çš„é¢‘é“</li>
<li>å‚æ•°ï¼špattern(ç»™å®šçš„æ¨¡å¼)</li>
<li>è¿”å›ï¼šè¿™ä¸ªå‘½ä»¤åœ¨ä¸åŒçš„å®¢æˆ·ç«¯ä¸­æœ‰ä¸åŒçš„è¡¨ç°ã€‚</li>
</ul>
<p>SUBSCRIBE channel [channel1 â€¦]</p>
<ul>
<li>è¯´æ˜ï¼šç”¨äºè®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯</li>
<li>å‚æ•°ï¼šchannel(ç»™å®šçš„é¢‘é“å)</li>
<li>è¿”å›ï¼šæ¥æ”¶åˆ°çš„ä¿¡æ¯</li>
</ul>
<p>UNSUBSCRIBE channel [channel1 â€¦]</p>
<ul>
<li>è¯´æ˜ï¼šç”¨äºé€€è®¢ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯</li>
<li>å‚æ•°ï¼šchannel(ç»™å®šçš„é¢‘é“å)</li>
<li>è¿”å›ï¼šè¿™ä¸ªå‘½ä»¤åœ¨ä¸åŒçš„å®¢æˆ·ç«¯ä¸­æœ‰ä¸åŒçš„è¡¨ç°</li>
</ul>
<p>PUBLISH channel message</p>
<ul>
<li>è¯´æ˜ï¼šç”¨äºå°†ä¿¡æ¯å‘é€åˆ°æŒ‡å®šçš„é¢‘é“</li>
<li>å‚æ•°ï¼šchannel(é¢‘é“åç§°)ï¼Œmessage(å°†è¦å‘é€çš„ä¿¡æ¯)</li>
<li>è¿”å›ï¼šæ¥æ”¶åˆ°æ­¤æ¶ˆæ¯çš„è®¢é˜…è€…æ•°é‡</li>
</ul>
<p>PUBSUB  &lt; subcommand &gt; argument [argument1 â€¦.]</p>
<ul>
<li>è¯´æ˜ï¼šç”¨äºæŸ¥çœ‹è®¢é˜…ä¸å‘å¸ƒç³»ç»ŸçŠ¶æ€ï¼Œå®ƒç”±æ•°ä¸ªä¸åŒæ ¼å¼çš„å­å‘½ä»¤ç»„æˆ</li>
<li>å‚æ•°ï¼šsubcommand(å­å‘½ä»¤)ï¼Œargument(å­å‘½ä»¤å‚æ•°)</li>
<li>è¿”å›ï¼šç”±æ´»è·ƒé¢‘é“ç»„æˆçš„åˆ—è¡¨</li>
<li>å­å‘½ä»¤å¦‚ä¸‹</li>
</ul>
<table>
<thead>
<tr>
<th>subcommand</th>
<th>argument</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>CHANNELS</td>
<td>[pattern]</td>
<td>è¿”å›æŒ‡å®šæ¨¡å¼patternçš„æ´»è·ƒçš„é¢‘é“,æŒ‡å®šè¿”å›ç”±SUBSCRIBEè®¢é˜…çš„é¢‘é“</td>
</tr>
<tr>
<td>NUMSUB</td>
<td>channel channel2 â€¦</td>
<td>è¿”å›æŒ‡å®šé¢‘é“çš„è®¢é˜…æ•°é‡</td>
</tr>
<tr>
<td>NUMPAT</td>
<td></td>
<td>è¿”å›è®¢é˜…æ¨¡å¼çš„æ•°é‡ï¼Œæ³¨æ„ï¼šè¿™ä¸ªå‘½ä»¤è¿”å›çš„ä¸æ˜¯è®¢é˜…æ¨¡å¼çš„å®¢æˆ·ç«¯çš„æ•°é‡ï¼Œ è€Œæ˜¯å®¢æˆ·ç«¯è®¢é˜…çš„æ‰€æœ‰æ¨¡å¼çš„æ•°é‡æ€»å’Œ</td>
</tr>
</tbody></table>
<blockquote>
<p>ä¸¾ä¸ªæ —å­<span class="github-emoji"><span>ğŸ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f34e.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
</blockquote>
<p>åœ¨è¿æ¥2ä¸­æˆ‘ä»¬å‘å¸ƒæ¶ˆæ¯</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803165009.png"></p>
<p>åœ¨è¿æ¥1ä¸­æ¥å—è®¢é˜…</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803165057.png"></p>
<blockquote>
<p>åº”ç”¨</p>
</blockquote>
<p>å¦‚å¾®ä¿¡å…¬ä¼—å·ï¼Œå¥½å‹åŠ¨æ€ï¼Œæ—¶äº‹æ¶ˆæ¯ç³»ç»Ÿï¼Œå®æ—¶èŠå¤©å®¤ï¼Œè®¢é˜…å…³æ³¨â€¦</p>
<h2 id="ä¸»ä»å¤åˆ¶"><a href="#ä¸»ä»å¤åˆ¶" class="headerlink" title="ä¸»ä»å¤åˆ¶"></a>ä¸»ä»å¤åˆ¶</h2><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–redisæœåŠ¡å™¨ä¸Šï¼Œå‰è€…ä¸ºmasterä¸»èŠ‚ç‚¹ï¼Œåè€…ä¸ºfollowerä»èŠ‚ç‚¹ï¼Œæ•°æ®å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ä»ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ï¼Œmasterä»¥å†™æ“ä½œä¸ºä¸»ï¼Œä»èŠ‚ç‚¹ä»¥è¯»ä¸ºä¸»ã€‚</p>
<p><strong>ä¸»ä»å¤åˆ¶çš„ä½œç”¨</strong></p>
<ol>
<li><p>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</p>
</li>
<li><p>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</p>
</li>
<li><p>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</p>
</li>
<li><p>è¯»å†™åˆ†ç¦»ï¼šå¯ä»¥ç”¨äºå®ç°è¯»å†™åˆ†ç¦»ï¼Œä¸»åº“å†™ã€ä»åº“è¯»ï¼Œè¯»å†™åˆ†ç¦»ä¸ä»…å¯ä»¥æé«˜æœåŠ¡å™¨çš„è´Ÿè½½èƒ½åŠ›ï¼ŒåŒæ—¶å¯æ ¹æ®éœ€æ±‚çš„å˜åŒ–ï¼Œæ”¹å˜ä»åº“çš„æ•°é‡ï¼›</p>
</li>
<li><p>é«˜å¯ç”¨åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€ã€‚</p>
</li>
</ol>
<p><strong>ä»èŠ‚ç‚¹å¼€å¯ä¸»ä»å¤åˆ¶ï¼Œæœ‰3ç§æ–¹å¼ï¼š</strong></p>
<ol>
<li><p>é…ç½®æ–‡ä»¶ï¼š åœ¨ä»æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ï¼šslaveof <masterip> <masterport></masterport></masterip></p>
</li>
<li><p>å¯åŠ¨å‘½ä»¤ï¼š redis-serverå¯åŠ¨å‘½ä»¤ååŠ å…¥ â€“slaveof <masterip> <masterport></masterport></masterip></p>
</li>
<li><p>å®¢æˆ·ç«¯å‘½ä»¤ï¼š RedisæœåŠ¡å™¨å¯åŠ¨åï¼Œç›´æ¥é€šè¿‡å®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤ï¼šslaveof <masterip>  <masterport>ï¼Œåˆ™è¯¥Rediså®ä¾‹æˆä¸ºä»èŠ‚ç‚¹ã€‚</masterport></masterip></p>
</li>
</ol>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210803213647.jpeg"></p>
<p>æ¯å°redisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼Œä½†æ¯ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹</p>
<blockquote>
<p>ä»…ä»…ä½¿ç”¨å•å°redisæœåŠ¡å™¨ä¼šé€ æˆçš„é—®é¢˜</p>
<p>1ï¼Œä»ç»“æ„ä¸Šæ¥è¯´ï¼Œå®¹æ˜“é€ æˆå•ç‚¹æ•…éšœå¹¶ä¸”è¯·æ±‚å‹åŠ›å¤§</p>
<p>2ï¼Œä»å®¹é‡ä¸Šæ¥è¯´ï¼Œå•ä¸ªredisæœåŠ¡å™¨å†…å­˜å®¹é‡æœ‰é™ï¼Œé€šå¸¸æ¥è¯´ï¼Œå•å°redisæœ€å¤§ä½¿ç”¨å†…å­˜ä¸åº”è¯¥è¶…è¿‡20G</p>
</blockquote>
<p><strong>ç›¸å…³æŒ‡ä»¤</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info repication <span class="comment">#æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>é…ç½®ä¸»ä»å¤åˆ¶ç¯å¢ƒ</strong></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šå°ç‰©ç†æœºæ¥å½“ä½œä»æœåŠ¡å™¨ï¼Œå½“ç„¶æˆ‘ä»¬å­¦ä¹ é˜¶æ®µå¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºè½¯ä»¶å®‰è£…å¤šä¸ªç³»ç»Ÿå½“ä½œä»èŠ‚ç‚¹ï¼Œè¿˜æœ‰ä¸€ä¸ªåŠæ³•å°±æ˜¯åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œé…ç½®å¤šä»½é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ä¸åŒçš„é…ç½®æ–‡ä»¶å¯åŠ¨ä¸åŒçš„å‡ ä¸ªredisæ•°æ®åº“ï¼Œåœ¨åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸‹æ­å»ºé›†ç¾¤ç¯å¢ƒã€‚</p>
<p>ä¾‹å¦‚ä¸»èŠ‚ç‚¹é€šè¿‡é…ç½®æ–‡ä»¶master.confå¯åŠ¨</p>
<p>å¤åˆ¶é…ç½®æ–‡ä»¶ï¼Œå¤åˆ¶ä¸‰åˆ†ï¼Œä¸¤ä»½ä¸ºä»èŠ‚ç‚¹ï¼Œä¸€åˆ†ä¸ºä¸»èŠ‚ç‚¹ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶åç§°åˆ†åˆ«ä¸ºï¼š</p>
<p>redis6380.conf     redis6381.conf    master.conf è¡¨ç¤ºåœ¨å¦å¤–ä¸‰ä¸ªç«¯å£ç›‘å¬è¯·æ±‚</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804092337.png"></p>
<p><em>åŒæ—¶æˆ‘ä»¬éœ€è¦ä¿®æ”¹è¿™ä¸‰ä»½é…ç½®æ–‡ä»¶å†…éƒ¨çš„rdbæ–‡ä»¶åé¿å…é‡å¤ï¼Œè¿˜æœ‰pidæ–‡ä»¶ï¼Œlogfileæ–‡ä»¶ï¼Œæœ€é‡è¦çš„è¿™ä¸‰ä»½é…ç½®æ–‡ä»¶çš„ç›‘å¬ç«¯å£åˆ†åˆ«ä¿®æ”¹ä¸º6380ï¼Œ6381ï¼Œ6379</em></p>
<p><span class="github-emoji"><span>ğŸ¥</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f425.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>æœ€åå¯ä»¥æŸ¥çœ‹ä»¥ä¸‹redisæœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°å¼€å¯äº†ä¸‰ä¸ªï¼Œåˆ†åˆ«åœ¨ä¸åŒçš„ç«¯å£</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804094454.png"></p>
<p> é‡‡ç”¨å‘½ä»¤æš‚æ—¶é…ç½®ä¸»ä»å…³ç³»ï¼š</p>
<p>ä¾‹å¦‚æˆ‘ä»¬åœ¨6380ä¸6381ç«¯å£å¤„redisæœåŠ¡ä¸‹æ‰§è¡Œ <strong>slaveof 127.0.0.1 6379</strong> åˆ™ç­‰åŒäºä¸ºè¿™ä¸¤ä¸ªredisæœåŠ¡é…ç½®ä¸»æœºï¼Œå†å»6379å¤„æŸ¥çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤å°ä»æœº</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804104008.png"></p>
<p>ä¿®æ”¹é…ç½®æ°¸ä¹…é…ç½®ä¸»ä»å…³ç³»ï¼š</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804094851.png"></p>
<p><span class="github-emoji"><span>ğŸ˜ƒ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f603.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>åˆ°æ­¤ä¸»ä»å¤åˆ¶åŸºæœ¬ç¯å¢ƒé…ç½®å®Œæˆ</p>
<blockquote>
<p>ä¸»ä»å¤åˆ¶ç»†èŠ‚</p>
</blockquote>
<p>ä¸»æœºèƒ½è¯»èƒ½å†™ï¼Œä»æœºå°†ä¸èƒ½å†™ï¼Œå¦‚åœ¨ä»æœºä¸Šæ‰§è¡Œset name rainä¼šå¤±è´¥</p>
<p>ä¸»æœºå†™å®Œåä»æœºå°†ä¼šè‡ªåŠ¨åŒæ­¥ä¸»æœºå†…å®¹ï¼Œå¦‚ä¸»æœº6379 è®¾ç½®äº†ä¸€ä¸ªå€¼ set name rain é‚£ä¹ˆä»æœº6380ï¼Œ6381å¯ä»¥get name å¾—åˆ°nameçš„å€¼ã€‚</p>
<p>ä¸»æœºæ–­å¼€äº†è¿æ¥ä»æœºä¾ç„¶èƒ½å¤Ÿç‹¬ç«‹å®Œæˆè¯»æ“ä½œè¯·æ±‚ã€‚</p>
<p>å¦‚æœæ˜¯é…ç½®æš‚æ—¶æ€§ä¸»ä»å…³ç³»ï¼Œä»æœºé‡å¯åä¼šå¤±å»ä¸»ä»å…³ç³»ï¼Œæ— æ³•åŒæ­¥ä¸»æœºæ•°æ®ï¼Œéœ€è¦é‡æ–°é…ç½®ï¼Œä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒä¸­éƒ½é…ç½®æ°¸ä¹…æ€§ä¸»ä»å…³ç³»ã€‚</p>
<blockquote>
<p>å¤åˆ¶åŸç†</p>
</blockquote>
<p>ä¸»ä»å¤åˆ¶è¿‡ç¨‹å¤§ä½“å¯ä»¥åˆ†ä¸º3ä¸ªé˜¶æ®µï¼šè¿æ¥å»ºç«‹é˜¶æ®µï¼ˆå³å‡†å¤‡é˜¶æ®µï¼‰ã€æ•°æ®åŒæ­¥é˜¶æ®µã€å‘½ä»¤ä¼ æ’­é˜¶æ®µã€‚</p>
<p><strong>å…¨é‡åŒæ­¥</strong><br>Rediså…¨é‡å¤åˆ¶ä¸€èˆ¬å‘ç”Ÿåœ¨Slaveåˆå§‹åŒ–é˜¶æ®µï¼Œè¿™æ—¶Slaveéœ€è¦å°†Masterä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½å¤åˆ¶ä¸€ä»½ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š<br>- ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨ï¼Œå‘é€SYNCå‘½ä»¤ï¼›<br>- ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ°SYNCå‘½ååï¼Œå¼€å§‹æ‰§è¡ŒBGSAVEå‘½ä»¤ç”ŸæˆRDBæ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ï¼›<br>- ä¸»æœåŠ¡å™¨BGSAVEæ‰§è¡Œå®Œåï¼Œå‘æ‰€æœ‰ä»æœåŠ¡å™¨å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ï¼›<br>- ä»æœåŠ¡å™¨æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ï¼›<br>- ä¸»æœåŠ¡å™¨å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»æœåŠ¡å™¨å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ï¼›<br>- ä»æœåŠ¡å™¨å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»æœåŠ¡å™¨ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼›</p>
<p><strong>å¢é‡åŒæ­¥</strong><br>Rediså¢é‡å¤åˆ¶æ˜¯æŒ‡Slaveåˆå§‹åŒ–åå¼€å§‹æ­£å¸¸å·¥ä½œæ—¶ä¸»æœåŠ¡å™¨å‘ç”Ÿçš„å†™æ“ä½œåŒæ­¥åˆ°ä»æœåŠ¡å™¨çš„è¿‡ç¨‹ã€‚<br>å¢é‡å¤åˆ¶çš„è¿‡ç¨‹ä¸»è¦æ˜¯ä¸»æœåŠ¡å™¨æ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å°±ä¼šå‘ä»æœåŠ¡å™¨å‘é€ç›¸åŒçš„å†™å‘½ä»¤ï¼Œä»æœåŠ¡å™¨æ¥æ”¶å¹¶æ‰§è¡Œæ”¶åˆ°çš„å†™å‘½ä»¤ã€‚</p>
<p><strong>Redisä¸»ä»åŒæ­¥ç­–ç•¥</strong><br>ä¸»ä»åˆšåˆšè¿æ¥çš„æ—¶å€™ï¼Œè¿›è¡Œå…¨é‡åŒæ­¥ï¼›å…¨åŒæ­¥ç»“æŸåï¼Œè¿›è¡Œå¢é‡åŒæ­¥ã€‚å½“ç„¶ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œslave åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥å‘èµ·å…¨é‡åŒæ­¥ã€‚redis ç­–ç•¥æ˜¯ï¼Œæ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä¼šå°è¯•è¿›è¡Œå¢é‡åŒæ­¥ï¼Œå¦‚ä¸æˆåŠŸï¼Œè¦æ±‚ä»æœºè¿›è¡Œå…¨é‡åŒæ­¥ã€‚</p>
<blockquote>
<p><span class="github-emoji"><span>âš </span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> å®•æœºåä¸»åŠ¨é…ç½®ä¸»æœºï¼Œéå“¨å…µæ¨¡å¼</p>
</blockquote>
<p> <img src="https://gitee.com/rain-sky/images/raw/master/20210804111419.png"></p>
<p>å‡è®¾æ­¤å¤„ä¸»èŠ‚ç‚¹å®•æœºäº†ï¼Œé‚£ä¹ˆä»èŠ‚ç‚¹1ä»ç„¶æ˜¯ä»èŠ‚ç‚¹ç‚¹ï¼Œæ— æ³•å®Œæˆå†™æ“ä½œï¼Œé‚£ä¹ˆæ€ä¹ˆé‡æ–°é€‰ä¸¾ä»–ä¸ºä¸»èŠ‚ç‚¹ï¼Œåœ¨ä»èŠ‚ç‚¹1ä½¿ç”¨å‘½ä»¤slaveof no oneå°†è‡ªå·±é…ç½®ä¸ºä¸»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹1å¯ä»¥å†™æ“ä½œï¼Œä»èŠ‚ç‚¹1çš„ä»èŠ‚ç‚¹ä¾ç„¶ä»ä»–å¤„åŒæ­¥æ•°æ®ä½†åªèƒ½è¯»ï¼Œé‡å¯ä¸»èŠ‚ç‚¹åï¼Œä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹å°±åªæœ‰ä»èŠ‚ç‚¹2äº†ã€‚</p>
<h2 id="å“¨å…µæ¨¡å¼"><a href="#å“¨å…µæ¨¡å¼" class="headerlink" title="å“¨å…µæ¨¡å¼"></a>å“¨å…µæ¨¡å¼</h2><h3 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h3><p><span class="github-emoji"><span>âš”</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2694.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>è‡ªåŠ¨è°‹æƒç¯¡ä½</p>
<p>Redis çš„ Sentinel ï¼ˆredis-sentinelç¨‹åºï¼‰ç³»ç»Ÿç”¨äºç®¡ç†å¤šä¸ª Redis æœåŠ¡å™¨ï¼ˆinstanceï¼‰ï¼Œ è¯¥ç³»ç»Ÿæ‰§è¡Œä»¥ä¸‹ä¸‰ä¸ªä»»åŠ¡ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoring</strong>ï¼‰ï¼š Sentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>
<li><strong>æé†’ï¼ˆNotificationï¼‰</strong>ï¼š å½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œ Sentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</li>
<li><strong>è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰</strong>ï¼š å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œ Sentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œ ä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚</li>
</ul>
<p>å“¨å…µæ¨¡å¼ä¸­å“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œå…¶åŸç†æ˜¯é€šè¿‡å“¨å…µå‘èŠ‚ç‚¹å‘é€å‘½ä»¤ç­‰å¾…redisæœåŠ¡å™¨å“åº”æ¥ç›‘æ§èŠ‚ç‚¹çŠ¶æ€ã€‚</p>
<p>å“¨å…µçš„ä½œç”¨ï¼š</p>
<ul>
<li>å‘é€å‘½ä»¤ç›‘æµ‹èŠ‚ç‚¹å“åº”ä»è€Œç›‘æ§æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€</li>
<li>ç›‘æµ‹åˆ°masterå®•æœºï¼Œè‡ªåŠ¨å°†slaveåˆ‡æ¢æˆmasterï¼Œç„¶åé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä½™æœåŠ¡å™¨ä¿®æ”¹é…ç½®æ–‡ä»¶åˆ‡æ¢ä¸»æœºã€‚</li>
</ul>
<blockquote>
<p>å•å“¨å…µ</p>
</blockquote>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804114247.webp"></p>
<p>å¦‚æœå“¨å…µè¿›ç¨‹å‡ºç°äº†é—®é¢˜ï¼Œé‚£ä¹ˆå“¨å…µæ¨¡å¼å°†ä¼šå´©åï¼Œä¸ºæ­¤å•ä¸ªå“¨å…µæ˜¯ä¸åˆé€‚çš„ã€‚</p>
<blockquote>
<p>å¤šå“¨å…µ</p>
</blockquote>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804114339.webp"></p>
<p>ç”¨æ–‡å­—æè¿°ä¸€ä¸‹<strong>æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰</strong>çš„è¿‡ç¨‹ã€‚å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œfailoverè¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡æˆä¸º<strong>ä¸»è§‚ä¸‹çº¿</strong>ã€‚å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œfailoveræ“ä½œã€‚åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å®¢è§‚ä¸‹çº¿</strong>ã€‚è¿™æ ·å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œä¸€åˆ‡éƒ½æ˜¯é€æ˜çš„ã€‚</p>
<h3 id="redisé…ç½®å“¨å…µæ¨¡å¼"><a href="#redisé…ç½®å“¨å…µæ¨¡å¼" class="headerlink" title="redisé…ç½®å“¨å…µæ¨¡å¼"></a>redisé…ç½®å“¨å…µæ¨¡å¼</h3><p>å…ˆæ­å»ºä¸€ä¸ªé“¾å¼ä¸»ä»é…ç½®</p>
<p>6379(master)-&gt;6380(slave)-&gt;6381(slave)</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804115619.png"></p>
<p><strong>å“¨å…µæ¨¡å¼é…ç½®æ–‡ä»¶</strong></p>
<p>ä¾‹å¦‚åœ¨usr/local/bin/myconfig/ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªsentinel.cofæ–‡ä»¶</p>
<p>æ ¸å¿ƒé…ç½®ï¼Œé…ç½®è¿œä¸æ­¢æ­¤</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sentinel monitor master 127.0.0.1 6379 1</span><br></pre></td></tr></tbody></table></figure>

<p>monitor: ç›‘æ§    master: è¢«ç›‘æ§çš„èŠ‚ç‚¹åç§°   host  port  1ä»£è¡¨ä¸»æœºæŒ‚äº†åä»æœºæŠ•ç¥¨é€‰ä¸¾æ–°ä¸»æœº</p>
<p>å¯åŠ¨å“¨å…µ</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-sentinel usr/<span class="built_in">local</span>/bin/myconfig/sentinel.conf</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804122903.png"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„masterä¸ä»–çš„slaveä¿¡æ¯ï¼Œç°åœ¨æˆ‘ä»¬å°è¯•å…³é—­masterï¼Œå¯ä»¥çœ‹åˆ°å“¨å…µæ§åˆ¶å°è¾“å‡º</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804124954.png"></p>
<p>æŸ¥çœ‹6380å¤„ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°6380é€šè¿‡ä¸€ä¸ªæŠ•ç¥¨ç®—æ³•è¢«é€‰ä¸¾ä¸ºæ–°çš„master</p>
<p><img src="https://gitee.com/rain-sky/images/raw/master/20210804125048.png"></p>
<p>å½“ä¸»æœºæ¢å¤åå°†ä½œä¸º6380çš„ä»æœº</p>
<blockquote>
<p>å°ç»“</p>
</blockquote>
<p>æœ‰ç‚¹ï¼š</p>
<p>1ï¼Œå“¨å…µé›†ç¾¤ï¼ŒåŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œæ‹¥æœ‰æ‰€æœ‰ä¸»ä»é…ç½®æœ‰ç‚¹</p>
<p>2ï¼Œä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœè½¬ç§»ç³»ç»Ÿå¯ç”¨æ€§æ›´å¥½</p>
<p>3ï¼Œä¸»åŠ¨å®Œæˆ</p>
<p>ç¼ºç‚¹ï¼š</p>
<p>1ï¼Œredisä¸é€‚åˆåœ¨çº¿æ‰©å®¹ï¼Œé›†ç¾¤å®¹é‡ä¸€æ—¦è¾¾åˆ°ä¸Šçº¿ï¼Œåœ¨çº¿æ‰©å®¹å°±æ˜¯é—®é¢˜</p>
<p>2ï¼Œå®ç°å“¨å…µæ¨¡å¼é…ç½®éº»çƒ¦</p>
<p>é…ç½®æ–‡ä»¶</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">port 26379 <span class="comment">#é…ç½®ç«¯å£ï¼Œå¦‚æœæœ‰å“¨å…µé›†ç¾¤</span></span><br><span class="line">dir /tmp <span class="comment">#å·¥ä½œç›®å½•</span></span><br><span class="line">sentinel down-after-milliseconfs mater <span class="comment">#æŒ‡å®šå¤šå°‘æ—¶é—´ä¸»èŠ‚ç‚¹æœªåº”ç­”å“¨å…µè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿</span></span><br></pre></td></tr></tbody></table></figure>





<h2 id="ç¼“å­˜ç©¿é€ä¸é›ªå´©"><a href="#ç¼“å­˜ç©¿é€ä¸é›ªå´©" class="headerlink" title="ç¼“å­˜ç©¿é€ä¸é›ªå´©"></a>ç¼“å­˜ç©¿é€ä¸é›ªå´©</h2><blockquote>
<p>ç¼“å­˜ç©¿é€</p>
</blockquote>
<p>æè¿°ï¼šè®¿é—®ä¸€ä¸ªç¼“å­˜å’Œæ•°æ®åº“éƒ½ä¸å­˜åœ¨çš„ keyï¼Œæ­¤æ—¶ä¼šç›´æ¥æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œå¹¶ä¸”æŸ¥ä¸åˆ°æ•°æ®ï¼Œæ²¡æ³•å†™ç¼“å­˜ï¼Œæ‰€ä»¥ä¸‹ä¸€æ¬¡åŒæ ·ä¼šæ‰“åˆ°æ•°æ®åº“ä¸Šã€‚</p>
<p>æ­¤æ—¶ï¼Œç¼“å­˜èµ·ä¸åˆ°ä½œç”¨ï¼Œè¯·æ±‚æ¯æ¬¡éƒ½ä¼šèµ°åˆ°æ•°æ®åº“ï¼Œæµé‡å¤§æ—¶æ•°æ®åº“å¯èƒ½ä¼šè¢«æ‰“æŒ‚ã€‚æ­¤æ—¶ç¼“å­˜å°±å¥½åƒè¢«â€œç©¿é€â€äº†ä¸€æ ·ï¼Œèµ·ä¸åˆ°ä»»ä½•ä½œç”¨ã€‚</p>
<p>1ã€<strong>æ¥å£æ ¡éªŒã€‚</strong>åœ¨æ­£å¸¸ä¸šåŠ¡æµç¨‹ä¸­å¯èƒ½ä¼šå­˜åœ¨å°‘é‡è®¿é—®ä¸å­˜åœ¨ key çš„æƒ…å†µï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ä¼šå‡ºç°å¤§é‡çš„æƒ…å†µï¼Œæ‰€ä»¥è¿™ç§åœºæ™¯æœ€å¤§çš„å¯èƒ½æ€§æ˜¯é­å—äº†éæ³•æ”»å‡»ã€‚å¯ä»¥åœ¨æœ€å¤–å±‚å…ˆåšä¸€å±‚æ ¡éªŒï¼šç”¨æˆ·é‰´æƒã€æ•°æ®åˆæ³•æ€§æ ¡éªŒç­‰ï¼Œä¾‹å¦‚å•†å“æŸ¥è¯¢ä¸­ï¼Œå•†å“çš„IDæ˜¯æ­£æ•´æ•°ï¼Œåˆ™å¯ä»¥ç›´æ¥å¯¹éæ­£æ•´æ•°ç›´æ¥è¿‡æ»¤ç­‰ç­‰ã€‚</p>
<p>2ã€<strong>ç¼“å­˜ç©ºå€¼</strong>ã€‚å½“è®¿é—®ç¼“å­˜å’ŒDBéƒ½æ²¡æœ‰æŸ¥è¯¢åˆ°å€¼æ—¶ï¼Œå¯ä»¥å°†ç©ºå€¼å†™è¿›ç¼“å­˜ï¼Œä½†æ˜¯è®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œè¯¥æ—¶é—´éœ€è¦æ ¹æ®äº§å“ä¸šåŠ¡ç‰¹æ€§æ¥è®¾ç½®ã€‚</p>
<p>3ã€<strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ã€‚ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å­˜å‚¨æ‰€æœ‰å¯èƒ½è®¿é—®çš„ keyï¼Œä¸å­˜åœ¨çš„ key ç›´æ¥è¢«è¿‡æ»¤ï¼Œå­˜åœ¨çš„ key åˆ™å†è¿›ä¸€æ­¥æŸ¥è¯¢ç¼“å­˜å’Œæ•°æ®åº“ã€‚</p>
<blockquote>
<p>ç¼“å­˜å‡»ç©¿</p>
</blockquote>
<p>æè¿°ï¼šæŸä¸€ä¸ªçƒ­ç‚¹ keyï¼Œåœ¨ç¼“å­˜è¿‡æœŸçš„ä¸€ç¬é—´ï¼ŒåŒæ—¶æœ‰å¤§é‡çš„è¯·æ±‚æ‰“è¿›æ¥ï¼Œç”±äºæ­¤æ—¶ç¼“å­˜è¿‡æœŸäº†ï¼Œæ‰€ä»¥è¯·æ±‚æœ€ç»ˆéƒ½ä¼šèµ°åˆ°æ•°æ®åº“ï¼Œé€ æˆç¬æ—¶æ•°æ®åº“è¯·æ±‚é‡å¤§ã€å‹åŠ›éª¤å¢ï¼Œç”šè‡³å¯èƒ½æ‰“å®æ•°æ®åº“ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>1ã€<strong>åŠ äº’æ–¥é”</strong>ã€‚åœ¨å¹¶å‘çš„å¤šä¸ªè¯·æ±‚ä¸­ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªè¯·æ±‚çº¿ç¨‹èƒ½æ‹¿åˆ°é”å¹¶æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ“ä½œï¼Œå…¶ä»–çš„çº¿ç¨‹æ‹¿ä¸åˆ°é”å°±é˜»å¡ç­‰ç€ï¼Œç­‰åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹å°†æ•°æ®å†™å…¥ç¼“å­˜åï¼Œç›´æ¥èµ°ç¼“å­˜ã€‚</p>
<p>å…³äºäº’æ–¥é”çš„é€‰æ‹©ï¼Œç½‘ä¸Šçœ‹åˆ°çš„å¤§éƒ¨åˆ†æ–‡ç« éƒ½æ˜¯é€‰æ‹© Redis åˆ†å¸ƒå¼é”ï¼Œå› ä¸ºè¿™ä¸ªå¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªè¯·æ±‚ä¼šèµ°åˆ°æ•°æ®åº“ï¼Œè¿™æ˜¯ä¸€ç§æ€è·¯ã€‚</p>
<p>ä½†æ˜¯å…¶å®ä»”ç»†æƒ³æƒ³çš„è¯ï¼Œè¿™è¾¹å…¶å®æ²¡æœ‰å¿…è¦ä¿è¯åªæœ‰ä¸€ä¸ªè¯·æ±‚èµ°åˆ°æ•°æ®åº“ï¼Œåªè¦ä¿è¯èµ°åˆ°æ•°æ®åº“çš„è¯·æ±‚èƒ½å¤§å¤§é™ä½å³å¯ï¼Œæ‰€ä»¥è¿˜æœ‰å¦ä¸€ä¸ªæ€è·¯æ˜¯ JVM é”ã€‚</p>
<p>JVM é”ä¿è¯äº†åœ¨å•å°æœåŠ¡å™¨ä¸Šåªæœ‰ä¸€ä¸ªè¯·æ±‚èµ°åˆ°æ•°æ®åº“ï¼Œé€šå¸¸æ¥è¯´å·²ç»è¶³å¤Ÿä¿è¯æ•°æ®åº“çš„å‹åŠ›å¤§å¤§é™ä½ï¼ŒåŒæ—¶åœ¨æ€§èƒ½ä¸Šæ¯”åˆ†å¸ƒå¼é”æ›´å¥½ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ˜¯ä½¿ç”¨â€œåˆ†å¸ƒå¼é”â€ï¼Œè¿˜æ˜¯â€œJVM é”â€ï¼ŒåŠ é”æ—¶è¦æŒ‰ key ç»´åº¦å»åŠ é”ã€‚</p>
<p>æˆ‘çœ‹ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªâ€œå›ºå®šçš„ keyâ€åŠ é”ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä¸åŒçš„ key ä¹‹é—´ä¹Ÿä¼šäº’ç›¸é˜»å¡ï¼Œé€ æˆæ€§èƒ½ä¸¥é‡æŸè€—ã€‚</p>
<p>ä½¿ç”¨ redis åˆ†å¸ƒå¼é”çš„ä¼ªä»£ç ï¼Œä»…ä¾›å‚è€ƒï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">getData</span><span class="params">(String key)</span> <span class="keyword">throws</span> InterruptedException </span>{</span><br><span class="line">    Object value = redis.get(key);</span><br><span class="line">    <span class="comment">// ç¼“å­˜å€¼è¿‡æœŸ</span></span><br><span class="line">    <span class="keyword">if</span> (value == <span class="keyword">null</span>) {</span><br><span class="line">        <span class="comment">// lockRedisï¼šä¸“é—¨ç”¨äºåŠ é”çš„redisï¼›</span></span><br><span class="line">        <span class="comment">// "empty"ï¼šåŠ é”çš„å€¼éšä¾¿è®¾ç½®éƒ½å¯ä»¥</span></span><br><span class="line">        <span class="keyword">if</span> (lockRedis.set(key, <span class="string">"empty"</span>, <span class="string">"PX"</span>, lockExpire, <span class="string">"NX"</span>)) {</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                <span class="comment">// æŸ¥è¯¢æ•°æ®åº“ï¼Œå¹¶å†™åˆ°ç¼“å­˜ï¼Œè®©å…¶ä»–çº¿ç¨‹å¯ä»¥ç›´æ¥èµ°ç¼“å­˜</span></span><br><span class="line">                value = getDataFromDb(key);</span><br><span class="line">                redis.set(key, value, <span class="string">"PX"</span>, expire);</span><br><span class="line">            } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">                <span class="comment">// å¼‚å¸¸å¤„ç†</span></span><br><span class="line">            } <span class="keyword">finally</span> {</span><br><span class="line">                <span class="comment">// é‡Šæ”¾é”</span></span><br><span class="line">                lockRedis.delete(key);</span><br><span class="line">            }</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">// sleep50msåï¼Œè¿›è¡Œé‡è¯•</span></span><br><span class="line">            Thread.sleep(<span class="number">50</span>);</span><br><span class="line">            <span class="keyword">return</span> getData(key);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<p>2ã€<strong>çƒ­ç‚¹æ•°æ®ä¸è¿‡æœŸ</strong>ã€‚ç›´æ¥å°†ç¼“å­˜è®¾ç½®ä¸ºä¸è¿‡æœŸï¼Œç„¶åç”±å®šæ—¶ä»»åŠ¡å»å¼‚æ­¥åŠ è½½æ•°æ®ï¼Œæ›´æ–°ç¼“å­˜ã€‚</p>
<p>è¿™ç§æ–¹å¼é€‚ç”¨äºæ¯”è¾ƒæç«¯çš„åœºæ™¯ï¼Œä¾‹å¦‚æµé‡ç‰¹åˆ«ç‰¹åˆ«å¤§çš„åœºæ™¯ï¼Œä½¿ç”¨æ—¶éœ€è¦è€ƒè™‘ä¸šåŠ¡èƒ½æ¥å—æ•°æ®ä¸ä¸€è‡´çš„æ—¶é—´ï¼Œè¿˜æœ‰å°±æ˜¯å¼‚å¸¸æƒ…å†µçš„å¤„ç†ï¼Œä¸è¦åˆ°æ—¶å€™ç¼“å­˜åˆ·æ–°ä¸ä¸Šï¼Œä¸€ç›´æ˜¯è„æ•°æ®ï¼Œé‚£å°±å‡‰äº†ã€‚</p>
<blockquote>
<p>ç¼“å­˜é›ªå´©</p>
</blockquote>
<p>æè¿°ï¼šå¤§é‡çš„çƒ­ç‚¹ key è®¾ç½®äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œå¯¼åœ¨ç¼“å­˜åœ¨åŒä¸€æ—¶åˆ»å…¨éƒ¨å¤±æ•ˆï¼Œé€ æˆç¬æ—¶æ•°æ®åº“è¯·æ±‚é‡å¤§ã€å‹åŠ›éª¤å¢ï¼Œå¼•èµ·é›ªå´©ï¼Œç”šè‡³å¯¼è‡´æ•°æ®åº“è¢«æ‰“æŒ‚ã€‚</p>
<p>ç¼“å­˜é›ªå´©å…¶å®æœ‰ç‚¹åƒâ€œå‡çº§ç‰ˆçš„ç¼“å­˜å‡»ç©¿â€ï¼Œç¼“å­˜å‡»ç©¿æ˜¯ä¸€ä¸ªçƒ­ç‚¹ keyï¼Œç¼“å­˜é›ªå´©æ˜¯ä¸€ç»„çƒ­ç‚¹ keyã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>1ã€<strong>è¿‡æœŸæ—¶é—´æ‰“æ•£</strong>ã€‚æ—¢ç„¶æ˜¯å¤§é‡ç¼“å­˜é›†ä¸­å¤±æ•ˆï¼Œé‚£æœ€å®¹æ˜“æƒ³åˆ°å°±æ˜¯è®©ä»–ä»¬ä¸é›†ä¸­ç”Ÿæ•ˆã€‚å¯ä»¥ç»™ç¼“å­˜çš„è¿‡æœŸæ—¶é—´æ—¶åŠ ä¸Šä¸€ä¸ªéšæœºå€¼æ—¶é—´ï¼Œä½¿å¾—æ¯ä¸ª key çš„è¿‡æœŸæ—¶é—´åˆ†å¸ƒå¼€æ¥ï¼Œä¸ä¼šé›†ä¸­åœ¨åŒä¸€æ—¶åˆ»å¤±æ•ˆã€‚</p>
<p>2ã€<strong>çƒ­ç‚¹æ•°æ®ä¸è¿‡æœŸ</strong>ã€‚è¯¥æ–¹å¼å’Œç¼“å­˜å‡»ç©¿ä¸€æ ·ï¼Œä¹Ÿæ˜¯è¦ç€é‡è€ƒè™‘åˆ·æ–°çš„æ—¶é—´é—´éš”å’Œæ•°æ®å¼‚å¸¸å¦‚ä½•å¤„ç†çš„æƒ…å†µã€‚</p>
<p>3ã€<strong>åŠ äº’æ–¥é”</strong>ã€‚è¯¥æ–¹å¼å’Œç¼“å­˜å‡»ç©¿ä¸€æ ·ï¼ŒæŒ‰ key ç»´åº¦åŠ é”ï¼Œå¯¹äºåŒä¸€ä¸ª keyï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»è®¡ç®—ï¼Œå…¶ä»–çº¿ç¨‹åŸåœ°é˜»å¡ç­‰å¾…ç¬¬ä¸€ä¸ªçº¿ç¨‹çš„è®¡ç®—ç»“æœï¼Œç„¶åç›´æ¥èµ°ç¼“å­˜å³å¯ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote>
<p>redisåŸºç¡€</p>
</blockquote>
<ol>
<li><p>redisæ˜¯ä»€ä¹ˆ</p>
<ul>
<li>ä¸€ç§key-valueå‹nosqlå†…å­˜æ•°æ®åº“</li>
</ul>
</li>
<li><p>redisåŸºæœ¬æ•°æ®ç±»å‹</p>
<ul>
<li>String</li>
<li>List</li>
<li>Set</li>
<li>Hash</li>
<li>Zset</li>
</ul>
</li>
<li><p>redisä¸‰ç§ç‰¹æ®Šç±»å‹</p>
<ul>
<li>geospatial</li>
<li>Hyperlog</li>
<li>Bitmaps</li>
</ul>
</li>
<li><p>redisäº‹åŠ¡</p>
<ul>
<li><p>redisäº‹åŠ¡å¼€å¯ï¼Œç»ˆæ­¢å„ç§æƒ…å†µ</p>
</li>
<li><p>redisäº‹åŠ¡ä¸ä¿è¯åŸå­æ€§</p>
</li>
<li><p>ä¸æ”¯æŒå›æ»šï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p>
</li>
</ul>
</li>
<li><p>redisæŒä¹…åŒ–</p>
<ul>
<li>RDBæ–¹å¼</li>
<li>AOFæ–¹å¼</li>
<li>ä¸¤ç§æŒä¹…åŒ–çš„åŸç†ï¼Œè¿‡ç¨‹</li>
<li>ä¸¤ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹</li>
</ul>
</li>
<li><p>rediså‘å¸ƒè®¢é˜…</p>
</li>
<li><p>redisä¸»ä»å¤åˆ¶</p>
<ul>
<li>ä¸»ä»å¤åˆ¶ç¯å¢ƒæ­å»º</li>
<li>é…ç½®ä¸»ä»å…³ç³»</li>
<li>ä¸»ä»å¤åˆ¶åŸç†</li>
</ul>
</li>
<li><p>rediså“¨å…µæ¨¡å¼</p>
<ul>
<li>é€‰ä¸¾æµç¨‹</li>
</ul>
</li>
<li><p>redisç¼“å­˜</p>
<ul>
<li>ç©¿é€</li>
<li>å‡»ç©¿</li>
<li>é›ªå´©</li>
<li>å„ç§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</li>
</ul>
</li>
<li><p>redisåˆ†å¸ƒå¼é”</p>
</li>
</ol>
<blockquote>
<p>é—®é¢˜</p>
</blockquote>
<p><strong>Redis</strong></p>
<ul>
<li>é¡¹ç›®ä¸­ä½¿ç”¨çš„ Redis ç‰ˆæœ¬</li>
<li>Redis åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨åœºæ™¯</li>
<li>Redis æ€ä¹ˆä¿è¯é«˜å¯ç”¨</li>
<li>Redis çš„é€‰ä¸¾æµç¨‹</li>
<li>Redis å’Œ Memcache çš„åŒºåˆ«</li>
<li>Redis çš„é›†ç¾¤æ¨¡å¼</li>
<li>Redis é›†ç¾¤è¦å¢åŠ åˆ†ç‰‡ï¼Œæ§½çš„è¿ç§»æ€ä¹ˆä¿è¯æ— æŸ</li>
<li>Redis åˆ†å¸ƒå¼é”çš„å®ç°</li>
<li>Redis åˆ é™¤è¿‡æœŸé”®çš„ç­–ç•¥</li>
<li>Redis çš„å†…å­˜æ·˜æ±°ç­–ç•¥</li>
<li>Redis çš„ Hash å¯¹è±¡åº•å±‚ç»“æ„</li>
<li>Redis ä¸­ Hash å¯¹è±¡çš„æ‰©å®¹æµç¨‹</li>
<li>Redis çš„ Hash å¯¹è±¡çš„æ‰©å®¹æµç¨‹åœ¨æ•°æ®é‡å¤§çš„æ—¶å€™ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—</li>
<li>Redis çš„æŒä¹…åŒ–æœºåˆ¶æœ‰å“ªå‡ ç§</li>
<li>RDB å’Œ AOF çš„å®ç°åŸç†ã€ä¼˜ç¼ºç‚¹</li>
<li>AOF é‡å†™çš„è¿‡ç¨‹</li>
<li>å“¨å…µæ¨¡å¼çš„åŸç†</li>
<li>ä½¿ç”¨ç¼“å­˜æ—¶ï¼Œå…ˆæ“ä½œæ•°æ®åº“è¿˜æ˜¯å…ˆæ“ä½œç¼“å­˜</li>
<li>ä¸ºä»€ä¹ˆæ˜¯è®©ç¼“å­˜å¤±æ•ˆï¼Œè€Œä¸æ˜¯æ›´æ–°ç¼“å­˜</li>
<li>ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©</li>
<li>æ›´æ–°ç¼“å­˜çš„å‡ ç§è®¾è®¡æ¨¡å¼</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">rain-Sky</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://rain-sky.github.io/2021/07/24/redis%E5%9F%BA%E7%A1%80/">https://rain-sky.github.io/2021/07/24/redis%E5%9F%BA%E7%A1%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a><a class="post-meta__tags" href="/tags/redis/">redis</a><a class="post-meta__tags" href="/tags/noSql/">noSql</a></div><div class="post_share"><div class="social-share" data-image="/img/10006.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/07/24/springSecurity/"><img class="prev-cover" src="/img/100018.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">springSecurity</div></div></a></div><div class="next-post pull-right"><a href="/2021/07/22/springboot/"><img class="next-cover" src="/img/100011.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">springboot</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/04/04/select-å­å¥åçš„åˆ—å–åˆ«åä¸èƒ½åº”ç”¨ä¸whereå­å¥çš„é—®é¢˜/" title="select å­å¥åçš„åˆ—å–åˆ«åä¸èƒ½åº”ç”¨ä¸whereå­å¥çš„é—®é¢˜"><img class="cover" src="/img/100019.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-04</div><div class="title">select å­å¥åçš„åˆ—å–åˆ«åä¸èƒ½åº”ç”¨ä¸whereå­å¥çš„é—®é¢˜</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://gitee.com/rain-sky/images/raw/master/20210814102605.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">rain-Sky</div><div class="author-info__description">åŠªåŠ›å‹‡æ•¢ä¸€ç‚¹ç‚¹</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">37</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/rain-sky"><i class="fab fa-github"></i><span>ç©ºé—´è½¬ç§»</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">æ­£åœ¨æ–½å·¥ing...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8noSql"><span class="toc-number">1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆä½¿ç”¨noSql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%9C%BAmysql%E6%97%B6%E4%BB%A3"><span class="toc-number">1.1.</span> <span class="toc-text">å•æœºmysqlæ—¶ä»£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Memcached-MySQL-%E5%9E%82%E7%9B%B4%E6%8B%86%E5%88%86"><span class="toc-number">1.2.</span> <span class="toc-text">Memcached+MySQL+å‚ç›´æ‹†åˆ†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mysql%E4%B8%BB%E4%BB%8E%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB"><span class="toc-number">1.3.</span> <span class="toc-text">Mysqlä¸»ä»è¯»å†™åˆ†ç¦»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8-%E6%B0%B4%E5%B9%B3%E6%8B%86%E5%88%86-mysql%E9%9B%86%E7%BE%A4"><span class="toc-number">1.4.</span> <span class="toc-text">åˆ†åº“åˆ†è¡¨+æ°´å¹³æ‹†åˆ†+mysqlé›†ç¾¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#noSql%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">1.5.</span> <span class="toc-text">noSqlçš„ä¼˜åŠ¿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis-%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">redis ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#linux%E4%B8%8B%E5%AE%89%E8%A3%85redis"><span class="toc-number">2.1.</span> <span class="toc-text">linuxä¸‹å®‰è£…redis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80"><span class="toc-number">3.</span> <span class="toc-text">åŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.1.</span> <span class="toc-text">redisæ•°æ®åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.</span> <span class="toc-text">äº”å¤§æ•°æ®ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#String%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.1.</span> <span class="toc-text">Stringå­—ç¬¦ä¸²ç±»å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#List%E5%88%97%E8%A1%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">Liståˆ—è¡¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set%E9%9B%86%E5%90%88"><span class="toc-number">3.2.3.</span> <span class="toc-text">seté›†åˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hash%E5%93%88%E5%B8%8C"><span class="toc-number">3.2.4.</span> <span class="toc-text">Hashå“ˆå¸Œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zset%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88"><span class="toc-number">3.2.5.</span> <span class="toc-text">zsetæœ‰åºé›†åˆ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E7%89%B9%E6%AE%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.</span> <span class="toc-text">ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#geospatial%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE"><span class="toc-number">3.3.1.</span> <span class="toc-text">geospatialåœ°ç†ä½ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hyperloglog"><span class="toc-number">3.3.2.</span> <span class="toc-text">Hyperloglog</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bitmaps"><span class="toc-number">3.3.3.</span> <span class="toc-text">Bitmaps</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E4%BA%8B%E5%8A%A1"><span class="toc-number">3.4.</span> <span class="toc-text">redisäº‹åŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#redis%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">3.4.1.</span> <span class="toc-text">redisäº‹åŠ¡å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E6%83%85%E5%86%B5%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.4.2.</span> <span class="toc-text">äº‹åŠ¡å¤„ç†æƒ…å†µç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#redis%E5%AE%9E%E7%8E%B0%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">3.4.3.</span> <span class="toc-text">rediså®ç°ä¹è§‚é”</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jedis"><span class="toc-number">4.</span> <span class="toc-text">jedis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#springboot%E6%95%B4%E5%90%88redis"><span class="toc-number">5.</span> <span class="toc-text">springbootæ•´åˆredis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis-conf"><span class="toc-number">6.</span> <span class="toc-text">redis.conf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">7.</span> <span class="toc-text">æŒä¹…åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RDB"><span class="toc-number">7.1.</span> <span class="toc-text">RDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOF"><span class="toc-number">7.2.</span> <span class="toc-text">AOF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85"><span class="toc-number">8.</span> <span class="toc-text">rediså‘å¸ƒè®¢é˜…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">9.</span> <span class="toc-text">ä¸»ä»å¤åˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F"><span class="toc-number">10.</span> <span class="toc-text">å“¨å…µæ¨¡å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">10.1.</span> <span class="toc-text">åŸºæœ¬ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E9%85%8D%E7%BD%AE%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F"><span class="toc-number">10.2.</span> <span class="toc-text">redisé…ç½®å“¨å…µæ¨¡å¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E4%B8%8E%E9%9B%AA%E5%B4%A9"><span class="toc-number">11.</span> <span class="toc-text">ç¼“å­˜ç©¿é€ä¸é›ªå´©</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">12.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/15/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%BD%92%E7%BA%B3/" title="æ’åºç®—æ³•å½’çº³"><img src="/img/10006.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ’åºç®—æ³•å½’çº³"/></a><div class="content"><a class="title" href="/2021/08/15/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%BD%92%E7%BA%B3/" title="æ’åºç®—æ³•å½’çº³">æ’åºç®—æ³•å½’çº³</a><time datetime="2021-08-15T09:50:21.000Z" title="Created 2021-08-15 17:50:21">2021-08-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/14/%E6%B7%B1%E6%80%9D%E7%86%9F%E8%99%91-%E9%80%89%E6%8B%A9%E8%80%83%E7%A0%94/" title="æ·±æ€ç†Ÿè™‘,é€‰æ‹©è€ƒç ”"><img src="/img/100019.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ·±æ€ç†Ÿè™‘,é€‰æ‹©è€ƒç ”"/></a><div class="content"><a class="title" href="/2021/08/14/%E6%B7%B1%E6%80%9D%E7%86%9F%E8%99%91-%E9%80%89%E6%8B%A9%E8%80%83%E7%A0%94/" title="æ·±æ€ç†Ÿè™‘,é€‰æ‹©è€ƒç ”">æ·±æ€ç†Ÿè™‘,é€‰æ‹©è€ƒç ”</a><time datetime="2021-08-14T01:50:08.000Z" title="Created 2021-08-14 09:50:08">2021-08-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/13/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%86%8D%E5%88%86%E6%9E%90/" title="Javaç±»åŠ è½½å†åˆ†æ"><img src="/img/10002.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Javaç±»åŠ è½½å†åˆ†æ"/></a><div class="content"><a class="title" href="/2021/08/13/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%86%8D%E5%88%86%E6%9E%90/" title="Javaç±»åŠ è½½å†åˆ†æ">Javaç±»åŠ è½½å†åˆ†æ</a><time datetime="2021-08-13T10:01:43.000Z" title="Created 2021-08-13 18:01:43">2021-08-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/11/%E5%85%B3%E4%BA%8EString-StringBuffer%E7%AD%89/" title="å…³äºString,StringBufferç­‰"><img src="/img/100013.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å…³äºString,StringBufferç­‰"/></a><div class="content"><a class="title" href="/2021/08/11/%E5%85%B3%E4%BA%8EString-StringBuffer%E7%AD%89/" title="å…³äºString,StringBufferç­‰">å…³äºString,StringBufferç­‰</a><time datetime="2021-08-11T08:15:38.000Z" title="Created 2021-08-11 16:15:38">2021-08-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/08/web%E9%A1%BB%E7%9F%A5/" title="webé¡»çŸ¥"><img src="/img/100017.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="webé¡»çŸ¥"/></a><div class="content"><a class="title" href="/2021/08/08/web%E9%A1%BB%E7%9F%A5/" title="webé¡»çŸ¥">webé¡»çŸ¥</a><time datetime="2021-08-08T11:01:16.000Z" title="Created 2021-08-08 19:01:16">2021-08-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By rain-Sky</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, æ¬¢è¿å…‰ä¸´é›¨æ°´çš„å°çª</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'TGj0zYjdRMW2f2kd8Jp7ehjN-gzGzoHsz',
      appKey: 'VTWVdzNGf2aAQR168F40vnOY',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="é›¨å¤©,è“è‰²,Aimer,Hiten,æŠ’æƒ…,çº¯éŸ³ä¹,æ—·é‡,æ˜Ÿç©º,å¾®é£,è“æµ·" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://python-github-calendar-api.vercel.app/api?rain-sky";
            var git_color =['#ebedf0', '#f1f8ff', '#dbedff', '#c8e1ff', '#79b8ff', '#2188ff', '#0366d6', '#005cc5', '#044289', '#032f62', '#05264c'];
            var git_user ="rain-sky";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log('å·²æŒ‚è½½github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // æ— æŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨(æ”¯æŒpjaxè·³è½¬)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // æœ‰æŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨(æ”¯æŒpjaxè·³è½¬)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>